<!-- TOC START min:1 max:3 link:true asterisk:false update:true -->
- [ハッシュ関数に関する攻撃とその耐性について](#ハッシュ関数に関する攻撃とその耐性について)
  - [攻撃の種類](#攻撃の種類)
  - [衝突攻撃/誕生日攻撃](#衝突攻撃誕生日攻撃)
  - [原像（げんぞう）攻撃](#原像げんぞう攻撃)
  - [衝突が発生する確率](#衝突が発生する確率)
  - [衝突耐性](#衝突耐性)
  - [衝突発見困難性（強衝突耐性）とは](#衝突発見困難性強衝突耐性とは)
  - [（第一）原像計算困難性（弱衝突耐性）とは](#第一原像計算困難性弱衝突耐性とは)
  - [第二原像計算困難性（弱衝突耐性）とは](#第二原像計算困難性弱衝突耐性とは)
<!-- TOC END -->


# ハッシュ関数に関する攻撃とその耐性について

## 攻撃の種類

関数 `f (x)` があるとき、 `f (x1) = f (x2)` となるような 2 つの異なる入力 `x1, x2` を求めることを  
暗号分野における攻撃と呼ぶ。この `x1, x2` のような組合せは **衝突** と呼ばれる。

暗号学において、このような衝突には2種類がある。 `x1` と `x2` の両方を攻撃者が任意に選ぶことができる場合と、  
片方は外部、たとえば送信者によって固定されており、攻撃者はもう片方について探すことしかできない場合、  
の2種類である。  
前者についての強度を **強衝突耐性** 、後者についての強度を **弱衝突耐性** と呼ぶ。  
前者の攻撃を **衝突攻撃** と呼び、後者の攻撃を **原像 (げんぞう) 攻撃** と呼ぶ。

## 衝突攻撃/誕生日攻撃

衝突攻撃 (誕生日攻撃) は上記「攻撃の種類」の項を参照。  
衝突攻撃と誕生日攻撃は同じ意味を持つ。


## 原像（げんぞう）攻撃

原像攻撃とは、特定のハッシュ値を持つメッセージを探索する攻撃のことである。  
元のメッセージそのものを探索するのか、元のメッセージと同じハッシュ値を生成する別のメッセージを  
探索するのかで、以下の二種類に分けられる。

- (第一) 原像攻撃 : 与えられたハッシュ値 `h` に対して、 `hash (m) = h` となるようなメッセージ `m` を探索する。
- 第二原像攻撃 : 与えられたメッセージ `m1` に対して、 `hash (m2) = hash (m1)` となるような別のメッセージ `m2` を探索する。


## 衝突が発生する確率

ハッシュ値が `N` ビットのとき、ハッシュ値のパターンは、全部で `2 の N 乗` 通り存在する。  
よって、ランダムに二つのメッセージをピックアップした場合に衝突が発生する確率は、  
`1 ÷ (2 の N 乗)` である。


## 衝突耐性

ハッシュ値が `N` ビットのときの強衝突耐性、弱衝突耐性は以下の通り。

衝突攻撃 (誕生日攻撃) が成功する試行回数の期待値は、 `2 の (N ÷ 2) 乗` である。  
原像攻撃が成功する試行回数の期待値は `(2 の N 乗) ÷ 2`(※1) である。  
```
(※1)  
N が非常に大きい場合、 "÷ 2" が計算結果に及ぼす影響は微々たるものであるため、 "÷ 2" を省略する場合もある。
```

例えば、 SHA-256 の場合は、ハッシュ値のビット長が 256 ビットであり、  
原像攻撃が成功する試行回数の期待値が `2 の 255 乗` となり、  
衝突攻撃 (誕生日攻撃) が成功する試行回数の期待値は、 `2 の 128 乗` となる。

したがって、衝突攻撃 (誕生日攻撃) の方がかなり攻撃が成功しやすいことがわかる。

これは、「誕生日のパラドックス」と同じ理屈である。

あるクラスの中で、自分と同じ誕生日の人がいる確率は低いが、そのクラスの誰か 2 人が同じ誕生日  
である確率は各段に高くなるという原理である。  
(参考：[誕生日のパラドックス](https://ja.wikipedia.org/wiki/%E8%AA%95%E7%94%9F%E6%97%A5%E3%81%AE%E3%83%91%E3%83%A9%E3%83%89%E3%83%83%E3%82%AF%E3%82%B9))

実際には、使用するハッシュ関数の散布度にも依存する。


## 衝突発見困難性（強衝突耐性）とは

衝突発見困難性とは、ハッシュ値が一致する、すなわち、  
`hash (M1) ＝ hash (M2)` となるようなメッセージ `M1` と `M2` を探索することが困難であること。


## （第一）原像計算困難性（弱衝突耐性）とは

ハッシュ値から元の入力値を探すことが困難であること、すなわち、  
`hash (M)` から元のメッセージ `M` を探索することが困難であること。


## 第二原像計算困難性（弱衝突耐性）とは

第二原像計算困難性とは、既知のメッセージ `M1` とそれに対するハッシュ値が与えられた時に、  
ハッシュ値が一致する、すなわち、  
`hash (M1) ＝ hash (M2)` となるようなメッセージ `M2` を探索することが困難であること。
