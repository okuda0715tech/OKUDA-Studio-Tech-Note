<!-- TOC START min:1 max:3 link:true asterisk:false update:true -->
- [ソルトとは](#ソルトとは)
  - [ソルトとは](#ソルトとは-1)
  - [どんな攻撃に対して有効であるか](#どんな攻撃に対して有効であるか)
    - [レインボーテーブルを使用した攻撃](#レインボーテーブルを使用した攻撃)
    - [複数ユーザーが同じパスワードを使用していることを利用した攻撃](#複数ユーザーが同じパスワードを使用していることを利用した攻撃)
  - [注意点](#注意点)
    - [ソルトの再利用は行わない](#ソルトの再利用は行わない)
    - [短すぎるソルト](#短すぎるソルト)
<!-- TOC END -->


# ソルトとは

## ソルトとは

ハッシュ関数の入力に平文を与える際に、平文をそのままハッシュ関数に与えるのではなく、  
平文にランダムな文字列を連結してからハッシュ関数の入力に与えることがある。  
このランダムな文字列のことをソルトと呼ぶ。

主に、パスワードをストレージに保存する際に利用される。  
パスワードをそのままハッシュ関数にかけるのではなく、 「パスワード + ソルト」 の文字列を  
ハッシュ関数にかけて、ストレージに保存する。

ソルトは主にパスワードなどの短い平文に対して付与することで、その効果が高くなる。  
メールの本文のような長い平文に対してソルトを付与しても、長い平文は、そもそもパターンが多すぎて  
レインボーテーブルを作成できないため、ソルトを付与する必要はない。


## どんな攻撃に対して有効であるか

### レインボーテーブルを使用した攻撃

レインボーテーブルとは、たくさんの平文とそのハッシュ値をペアで保存したテーブルのことである。  
攻撃者が何らかの方法で、ハッシュ値を取得した場合、このテーブルを参照することで、  
パスワードを推測し、攻撃を試みることがある。ソルトはこの攻撃を防ぐのに効果的である。


### 複数ユーザーが同じパスワードを使用していることを利用した攻撃

（ユーザごとに異なるソルトを利用していることが前提）

複数ユーザーが同じパスワードを使用している場合、ソルトを付与せずに生成したハッシュ値は  
同じ値になってしまう。しかし、ソルトは通常、ユーザごとに異なる値を使用するため、同じパスワード  
を使用しているユーザが複数存在していたとしても、ユーザごとに異なるハッシュ値を生成することができる。  
そのため、誰か一人のパスワードが判明したとしても、その人と同じパスワードを使用している人の  
アカウントを攻撃から守ることができる。


## 注意点

### ソルトの再利用は行わない

ソルトがハードコーディングされると、そこから抽出したソルトを使って新しいレインボーテーブルを生成できてしまう。  

また、ソルトが固定だと、パスワードが同じユーザーはハッシュ値も同じになってしまう  
（ハッシュ値を作る際にユーザ名を混ぜ込んでいる場合を除く）。
これにより、一つのハッシュ値で複数のユーザーを攻撃するのが容易になってしまう。


### 短すぎるソルト

ソルトが短すぎると、パスワード＋ソルトの長さが短くなる可能性があり、そうなると、  
よくあるパスワードと単純なソルトの組み合わせにより、  
少ないパターンのレインボーテーブルで攻撃が成功してしまう可能性がある。  
パスワードが長ければ長いほど、レインボーテーブルの準備が困難になるため、  
レインボーテーブルを使用した攻撃を防ぎやすくなる。
