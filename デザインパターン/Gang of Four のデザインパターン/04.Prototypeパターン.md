- [Prototype パターン](#prototype-パターン)
  - [役割](#役割)
  - [実装方法](#実装方法)
    - [【参考】シャローコピーとディープコピーの違い](#参考シャローコピーとディープコピーの違い)
  - [使いどころ](#使いどころ)
    - [Intent の生成](#intent-の生成)
    - [インスタンスの生成コストを抑えたい場合](#インスタンスの生成コストを抑えたい場合)
    - [インスタンス生成時にクラス名を書かなくて済むため、疎結合になる](#インスタンス生成時にクラス名を書かなくて済むため疎結合になる)


# Prototype パターン

## 役割

原型・模範となるクラスを元にインスタンスを生成します。通常の方法では、インスタンスの生成が困難な場合に使用します。


## 実装方法

- Java では、 Object クラスに定義されている clone() メソッドを使用して実装することが多いです。
- Kotlin では、 data class の場合に自動で生成される copy() 関数を使用して実装することが多いです。

いずれもシャローコピーなので、ディープコピーするには、別途対応が必要です。

### 【参考】シャローコピーとディープコピーの違い

- シャローコピー（Shallow Copy）
  - オブジェクトのトップレベルの値だけをコピー。
  - 参照型のフィールド（リストや別のオブジェクトなど）は同じインスタンスを共有する。
  - 元とコピーで、参照先が共通になってしまう。

- ディープコピー（Deep Copy）
  - オブジェクトの中にあるすべてのオブジェクトを再帰的にコピー。
  - 参照型フィールドも新しいインスタンスにコピーされる。
  - 元とコピーは完全に独立する。


## 使いどころ

### Intent の生成

```kotlin
val baseIntent = Intent(context, SomeActivity::class.java).apply {
    putExtra("common_key", "value")
}

val newIntent = Intent(baseIntent).apply {
    putExtra("user_id", 123)
}
```


### インスタンスの生成コストを抑えたい場合

インスタンスを生成する際に、データベースへのアクセスが必要な場合など、インスタンスの生成にコストがかかる場合は、コピーして生成した方が遥かにコストが低くなります。


### インスタンス生成時にクラス名を書かなくて済むため、疎結合になる

部品として再利用しやすい。（クラス名が変わっても生成部分のコード修正が不要など。）

