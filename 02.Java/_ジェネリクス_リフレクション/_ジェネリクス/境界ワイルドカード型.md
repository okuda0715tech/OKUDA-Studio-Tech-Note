- [境界ワイルドカード型](#境界ワイルドカード型)
  - [概要](#概要)
  - [以下の例で使用するクラスの継承関係](#以下の例で使用するクラスの継承関係)
  - [List\<? extends A\> の特性](#list-extends-a-の特性)
  - [List\<? super A\> の特性](#list-super-a-の特性)
  - [PECS ( extends か super どちらを使用するべきかを判断する方法)](#pecs--extends-か-super-どちらを使用するべきかを判断する方法)


# 境界ワイルドカード型

## 概要

「境界ワイルドカード型」 とは、  
`List<? extends MyClass>` や `List<? super MyClass>` などのように  
`extends` もしくは `super` を使用して、上限 or 下限を指定したワイルドカード型のことです。

境界ワイルドカード型は、変数を格納する型として使用します。


## 以下の例で使用するクラスの継承関係

```java
public class Animal {
	...
}
```

```java
public class Dog extends Animal {
	...
}
```

```java
public class SmallDog extends Dog {
	...
}
```

```java
public class BigDog extends Dog {
	...
}
```


## List\<? extends A> の特性


**リスト代入時の型チェック**

```Java
// コンパイルエラー ( 「 Dog のサブクラスのうち何か特定の型」を意味するためエラーとなる)
List<? extends Dog> dogList1 = new ArrayList<Animal>();
// OK
List<? extends Dog> dogList2 = new ArrayList<Dog>();
// OK
List<? extends Dog> dogList3 = new ArrayList<SmallDog>();
```


**取得した要素の型チェック**

```java
List<? extends Dog> dogList = new ArrayList<Dog>();
// OK
Animal animal = dogList.get(0);
// OK
Dog dog = dogList.get(0);
// コンパイルエラー ( BigDog 型の可能性もあるためエラー)
SmallDog smallDog = dogList.get(0);
```


**要素の追加・更新制限**

`List<? extends Dog>` コンパイル時には要素の型が特定できないため、要素の追加・更新は、  
どのような実型引数であっても、すべてコンパイルエラーになります。

```
【参考】  
動的に型チェックを行っても、元のワイルドカード型 (例えば `List<? extends Dog>` など) の  
実型自体を変更することはできないため、その変数に入っている限りは、要素の追加・更新はできません。

`List<? extends Dog>` から要素を取り出して、 `List<Dog>` 型などの変数にデータを詰め替えれば、  
詰め替え後の変数で、要素の追加・更新は可能になります。
```


## List\<? super A> の特性

**リスト代入時の型チェック**

```Java
// OK
List<? super Dog> dogList1 = new ArrayList<Animal>();
// OK
List<? super Dog> dogList2 = new ArrayList<Dog>();
// コンパイルエラー ( 「 Dog のスーパークラスのうち何か特定の型」を意味するためエラーとなる)
List<? super Dog> dogList3 = new ArrayList<SmallDog>();
```


**取得した要素の型チェック**

```java
List<? super Dog> dogList = new ArrayList<Dog>();
// OK
Object object = dogList.get(0);
// コンパイルエラー
Animal animal = dogList.get(0);
// コンパイルエラー
Dog dog = dogList.get(0);
// コンパイルエラー
SmallDog smallDog = dogList.get(0);
```


**要素の追加・更新制限**

```java
List<? super Dog> dogList = new ArrayList<Dog>();
// 追加
// コンパイルエラー
dogList.add(new Animal());
// OK
dogList.add(new Dog());
// OK
dogList.add(new SmallDog());
// 更新
// コンパイルエラー
dogList.set(0, new Animal());
// OK
dogList.set(0, new Dog());
// OK
dogList.set(0, new SmallDog());
```


## PECS ( extends か super どちらを使用するべきかを判断する方法)

PECS とは、 「 **P**roducer なら **E**xtends を使用し、 **C**onsumer なら **S**uper を使用する」 という、  
`extends` と `super` の使い分け方を覚えるための頭文字を連結したものです。

