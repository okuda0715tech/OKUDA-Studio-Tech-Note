<!-- TOC depthFrom:1 depthTo:6 withLinks:1 updateOnSave:1 orderedList:0 -->

- [ファイル読み込み](#ファイル読み込み)
	- [〜Streamを使うか〜Readerを使うか](#streamを使うかreaderを使うか)
	- [バッファリングを搭載していない3つのクラスは全く使用しないか？](#バッファリングを搭載していない3つのクラスは全く使用しないか)
	- [サンプルコード](#サンプルコード)
		- [BufferedInputStreamサンプル](#bufferedinputstreamサンプル)
		- [BufferedReaderサンプル](#bufferedreaderサンプル)

<!-- /TOC -->


# ファイル読み込み

ファイル読み込みを行うには、以下の5つのクラスから必要なクラスを使用します。

`FileInputStream, BufferedInputStream, FileReader, BufferedReader, InputStreamReader`

詳細は以下の表を参照してください。

クラス名             | バイナリ <-> 文字 変換 | バッファリング有無 | 説明
---------------------|------------------------|--------------------|-----
FileInputStream     | なし                   | なし               |このクラスのwriteメソッドを使用することはない。なぜなら、バッファリングを搭載している上位クラスが存在するため。
BufferedInputStream | なし                   | あり               |
FileReader           | あり                   | なし               |このクラスのwriteメソッドを使用することはない。なぜなら、バッファリングを搭載している上位クラスが存在するため。
BufferedReader       | あり                   | あり               |
InputStreamReader   | あり                   | なし               |このクラスのwriteメソッドを使用することはない。なぜなら、バッファリングを搭載している上位クラスが存在するため。


## 〜Streamを使うか〜Readerを使うか

**〜Streamはバイナリデータの読み込み、〜Readerは文字の読み込み**

クラス名の最後が`Stream`で終わるものの`read()`メソッドを使用すると、読み込んだデータをそのままメモリに保持します。

クラス名の最後が`Reader`で終わるものの`read()`メソッドを使用すると、読み込んだデータを文字コードで文字に変換してメモリに保持します。


## バッファリングを搭載していない3つのクラスは全く使用しないか？

全く使用しないわけではありません。
readメソッドを使用しないというだけであり、バッファリングを搭載しているクラスのメソッド使用時に、パラメーターとしてこれらのオブジェクトを渡します。


## サンプルコード

### BufferedInputStreamサンプル

```Java
class BISSample {
    public static void main(String args[]) throws IOException {
        String inputFile = "/xxx/aaa.txt";
        FileInputStream fis = new FileInputStream(inputFile);
        BufferedInputStream bis = new BufferedInputStream(fis);
        int code;

        while ((code = bis.read()) != -1) {
            System.out.print(Integer.toHexString(code));
        }

        bis.close();
    }
}
```


### BufferedReaderサンプル

**サンプル1**

サンプル1は、Javaの基本的なファイル読み込みです。
Androidではあまり使わないと思います。

```java
class Sample1 {
    public static void main(String args[]) throws IOException {
        String outputFile = "/xxx/aaa.txt";
        FileWriter fw = new FileWriter(outputFile);
        BufferedWriter bw = new BufferedWriter(fw);
        bw.write("abcあいう");
        bw.newLine(); //「BufferedWriter」には行区切り文字（改行）のメソッドが用意されています。
        bw.close();
    }
}
```


**サンプル2**

`data/data/パッケージ名/files`ディレクトリの下にサブディレクトリを構築する場合は、このサンプル2のやり方で実装する必要があります。

```java
public static String getFileContent(String path, Context context) throws IOException {
		// pathには、/xxx/aaa.txtなどのパスとファイル名の連結文字列が入る。
		File f = new File(context.getFilesDir(), path);
		FileInputStream fis = new FileInputStream(f);
		InputStreamReader isr = new InputStreamReader(fis);
		// 文字コードを指定する場合は第二引数に指定します。
		// InputStreamReader isr = new InputStreamReader(fis,"UTF-8");
		BufferedReader reader = new BufferedReader(isr);

		String line;
		StringBuilder content = new StringBuilder();

		if ((line = reader.readLine()) != null) {
				content.append(line);
		}
		while ((line = reader.readLine()) != null) {
				content.append('\n').append(line);
		}

		reader.close();

		return content.toString();
}
```

`context.getFilesDir()`メソッドは、`data/data/パッケージ名/files`ディレクトリのパスを取得するメソッドです。


**サンプル3**

filesディレクトリの下にサブディレクトリを構築せず、files直下のファイルのみを読み込む場合には、サンプル3の方法をとります。

```Java
public static String getFileContent(String fileName, Context context) throws IOException {
		FileInputStream fis = context.openFileInput(fileName);
		InputStreamReader isr = new InputStreamReader(fis);
		BufferedReader reader = new BufferedReader(isr);

		String line;
		StringBuilder content = new StringBuilder();

		if ((line = reader.readLine()) != null) {
				content.append(line);
		}
		while ((line = reader.readLine()) != null) {
				content.append('\n').append(line);
		}

		reader.close();

		return content.toString();
}
```



