<!-- TOC START min:1 max:3 link:true asterisk:false update:true -->
- [演算と型](#演算と型)
  - [原則](#原則)
  - [演算の例（ `A = B + C` を例に考える。）](#演算の例-a--b--c-を例に考える)
    - [基本](#基本)
    - [注意](#注意)
  - [代入の例](#代入の例)
  - [数値リテラルの例](#数値リテラルの例)
  - ['a / b': integer division in floating-point context ワーニング](#a--b-integer-division-in-floating-point-context-ワーニング)
<!-- TOC END -->


# 演算と型

## 原則

- 演算
  - 四則演算される変数が異なる型である場合、大きい方の型にそろえてから演算が行われる。
  - そのため、演算結果は、演算される変数の中で一番大きな型と同じになる。
- 代入
  - 自分の型よりも小さい型の変数に代入する場合は、明示的なキャストが必要
- 数値リテラル
  - 数値リテラルはデフォルトで特定の型を持っている。


## 演算の例（ `A = B + C` を例に考える。）


### 基本

`A = B + C` という演算を例に考えます。

まずは、右辺の型がチェックされます。  
`B` と `C` の型がチェックされ、これらの型が異なる場合は、  
小さい方の型が大きい方の型に合わせて変換されます。  
例えば、 `B` が `int` 型で、 `C` が `long` 型である場合は、  
`B` が `long` 型に変換されてから加算が実施されます。

上記の通り、 `B + C` は同じ型同士の演算となるため、その結果も、同じ型となります。  
よって、演算結果を代入する `A` は、 `B` と `C` のうち、大きい方の型に合わせた型にします。


### 注意

先ほど、 `小さい方の型が大きい方の型に変換される` と書きましたが、少し注意が必要です。  

型変換の正確な優先順位は以下の通りです。  
`double > float > long > int`  
この変換優先順位の中に `short` 型や `byte` 型が存在しないことにも注意してください。


#### 小数と整数が混在する場合

小数と整数が混在する場合は、上記の正確な変換優先順位に従って変換されると覚えておけばOKです。

例えば、 `float` 型と `long` 型が混在した演算の場合は、 `float` の方が優先順位が高いため、  
`long` 型が `float` 型に変換されてから演算が行われます。


#### short型やbyte型を扱う場合

変換の優先順位には `short` 型や `byte` 型は含まれていません。  
`short` 型や `byte` 型は、たとえ `short` 型同士や `byte` 型同士の演算であっても、  
必ず `int` 型に変換されてから演算が実施されることに注意してください。


## 代入の例

以下に例を示す。

```Java
int a = 1;
short b = (short) a; // 明示的にキャストしないとエラーとなり、コンパイルできない。
// 【補足】
// Javaの仕様では、 a が short 型に収まる値ならエラーにならないらしいが、
// Android Studio でコーディングする場合には、収まる値でもエラーとなり、コンパイルできない。
```


## 数値リテラルの例

`int a = 10` のように、コードに直接記述した値のことを `数値リテラル` と呼ぶ。  
この数値リテラルには、デフォルトで特定の型が割り当てられている。  
整数には `int` 型、小数には `double` 型が割り当てられる。


## 'a / b': integer division in floating-point context ワーニング

このワーニングは、以下のような場合に発生します。

```Java
int a = 10;
int b = 4;
float c = a / b; // {a / b} の部分でワーニングが表示されます。
```

このワーニングが意味するところは、以下の通りです。

```
「int型同士の割り算によって、結果がint型になるため、小数点以下の情報は失われます。
それにもかかわらず、結果をfloat型で受け取っているため、あなたは、小数点以下が失われることに
気が付いていないのではありませんか？」
```
