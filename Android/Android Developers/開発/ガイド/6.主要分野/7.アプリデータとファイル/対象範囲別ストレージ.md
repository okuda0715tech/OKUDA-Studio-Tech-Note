- [対象範囲別ストレージ（Scoped Storage）](#対象範囲別ストレージscoped-storage)
  - [概要](#概要)
  - [3 種類のデータ](#3-種類のデータ)
    - [各アプリ専用のストレージ](#各アプリ専用のストレージ)
    - [メディアファイル用のストレージ](#メディアファイル用のストレージ)
    - [ドキュメント、その他のファイル用のストレージ](#ドキュメントその他のファイル用のストレージ)
    - [まとめ](#まとめ)


# 対象範囲別ストレージ（Scoped Storage）

## 概要

対象範囲別ストレージとは、外部ストレージ ( SD カードや USB メモリ等) の保存領域をデータの種類ごとに分類して保存する仕組み (概念) です。

Android 10 (API Level 29) から導入された概念であり、それより前の Android OS では使用できない仕組みであると思われます。


## 3 種類のデータ

対象範囲別ストレージでは、外部ストレージに保存するデータを以下の 3 種類に分類します。

- 各アプリ専用のストレージ
- メディアファイル用のストレージ
- ドキュメント、その他のファイル用のストレージ


### 各アプリ専用のストレージ

Android 10 未満では、外部ストレージ上に構築された各アプリ専用のストレージは、外部のアプリからアクセス可能でした。しかし、 Android 10 以降では、アクセスができないようになりました。よって、機密情報を含むデータにも暗号化を施す必要がなくなりました。


### メディアファイル用のストレージ

メディアファイル用のストレージを使用するには、 MediaStore API を使用します。 MediaStore API は、メディアプロバイダとアプリの間を取り持つや役割を担います。

このストレージに保存できるデータは、以下の 3 種類です。

- 動画
- 写真
- 音声


### ドキュメント、その他のファイル用のストレージ



### まとめ

| 項目                             | アプリ専用   | メディア用     | ドキュメント・その他用  |
| -------------------------------- | ------------ | -------------- | ----------------------- |
| 外部アプリからのアクセス         | △ (※ 1 )     | △ (※ 2 )       |                         |
| アクセス方法                     | Platform API | MediaStore API | Strage Access Framework |
| アンインストール時にデータが削除 | される       |                |                         |


(※ 1 )  
Manifest.permission.WRITE_EXTERNAL_STORAGE 権限を持っているアプリから書き込みが可能

(※ 2 )  
- 参照には、インストール権限 READ_EXTERNAL_STORAGE が必要
- 更新には、ファイル毎に動的なユーザーの許可が必要


