- [ãƒ–ãƒ©ã‚· : ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã‚·ã‚§ãƒ¼ãƒ€ãƒ¼](#ãƒ–ãƒ©ã‚·--ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã‚·ã‚§ãƒ¼ãƒ€ãƒ¼)
  - [ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ–ãƒ©ã‚·](#ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ–ãƒ©ã‚·)
    - [colorStops ã§è‰²ã®åˆ†å¸ƒã‚’å¤‰æ›´ã™ã‚‹](#colorstops-ã§è‰²ã®åˆ†å¸ƒã‚’å¤‰æ›´ã™ã‚‹)
    - [TileMode ã§ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ç¹°ã‚Šè¿”ã™](#tilemode-ã§ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ç¹°ã‚Šè¿”ã™)
    - [ãƒ–ãƒ©ã‚·ã‚µã‚¤ã‚ºã‚’å¤‰æ›´ã™ã‚‹](#ãƒ–ãƒ©ã‚·ã‚µã‚¤ã‚ºã‚’å¤‰æ›´ã™ã‚‹)
  - [ç”»åƒã‚’ãƒ–ãƒ©ã‚·ã¨ã—ã¦ä½¿ç”¨ã™ã‚‹](#ç”»åƒã‚’ãƒ–ãƒ©ã‚·ã¨ã—ã¦ä½¿ç”¨ã™ã‚‹)
  - [é«˜åº¦ãªä¾‹: ã‚«ã‚¹ã‚¿ãƒ ãƒ–ãƒ©ã‚·](#é«˜åº¦ãªä¾‹-ã‚«ã‚¹ã‚¿ãƒ ãƒ–ãƒ©ã‚·)
    - [AGSL ã® RuntimeShader ãƒ–ãƒ©ã‚·](#agsl-ã®-runtimeshader-ãƒ–ãƒ©ã‚·)
  - [å‚è€ƒæƒ…å ±](#å‚è€ƒæƒ…å ±)


# ãƒ–ãƒ©ã‚· : ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã‚·ã‚§ãƒ¼ãƒ€ãƒ¼ 

Compose ã® [Brush](https://developer.android.com/reference/kotlin/androidx/compose/ui/graphics/Brush?hl=ja&_gl=1*5jb017*_up*MQ..*_ga*MTQ1NzI0ODE0NC4xNzI2NzI4Nzk2*_ga_6HH9YJMN9M*MTcyNjcyODc5Ni4xLjAuMTcyNjcyODc5Ni4wLjAuNzY3NTIxMjY2) ã§ã¯ã€ç”»é¢ä¸Šã§ä½•ã‹ã‚’æç”»ã™ã‚‹éš›ã®æ‰‹æ³•ã‚’è¨˜è¿°ã—ã¾ã™ã€‚ã“ã‚Œã¯ã€æç”»é ˜åŸŸï¼ˆå††ã€å››è§’ã€ãƒ‘ã‚¹ãªã©ï¼‰ã«é©ç”¨ã•ã‚Œã‚‹è‰²ã‚’å®šç¾©ã™ã‚‹ã‚‚ã®ã§ã™ã€‚ [LinearGradient](https://developer.android.com/reference/kotlin/androidx/compose/ui/graphics/LinearGradient?hl=ja&_gl=1*5jb017*_up*MQ..*_ga*MTQ1NzI0ODE0NC4xNzI2NzI4Nzk2*_ga_6HH9YJMN9M*MTcyNjcyODc5Ni4xLjAuMTcyNjcyODc5Ni4wLjAuNzY3NTIxMjY2) ãƒ–ãƒ©ã‚·ã€ [RadialGradient](https://developer.android.com/reference/kotlin/androidx/compose/ui/graphics/RadialGradient?hl=ja&_gl=1*5jb017*_up*MQ..*_ga*MTQ1NzI0ODE0NC4xNzI2NzI4Nzk2*_ga_6HH9YJMN9M*MTcyNjcyODc5Ni4xLjAuMTcyNjcyODc5Ni4wLjAuNzY3NTIxMjY2) ãƒ–ãƒ©ã‚·ã€å˜è‰²ã® [SolidColor](https://developer.android.com/reference/kotlin/androidx/compose/ui/graphics/SolidColor?hl=ja&_gl=1*5jb017*_up*MQ..*_ga*MTQ1NzI0ODE0NC4xNzI2NzI4Nzk2*_ga_6HH9YJMN9M*MTcyNjcyODc5Ni4xLjAuMTcyNjcyODc5Ni4wLjAuNzY3NTIxMjY2) ãƒ–ãƒ©ã‚·ãªã©ã€æç”»ã§å½¹ã«ç«‹ã¤çµ„ã¿è¾¼ã¿ã®ãƒ–ãƒ©ã‚·ãŒã„ãã¤ã‹ç”¨æ„ã•ã‚Œã¦ã„ã¾ã™ã€‚

ãƒ–ãƒ©ã‚·ã¯ã€ [Modifier.background()](https://developer.android.com/reference/kotlin/androidx/compose/ui/Modifier?hl=ja&_gl=1*5jb017*_up*MQ..*_ga*MTQ1NzI0ODE0NC4xNzI2NzI4Nzk2*_ga_6HH9YJMN9M*MTcyNjcyODc5Ni4xLjAuMTcyNjcyODc5Ni4wLjAuNzY3NTIxMjY2#(androidx.compose.ui.Modifier.background(androidx.compose.ui.graphics.Color,androidx.compose.ui.graphics.Shape))) ã€ [TextStyle](https://developer.android.com/reference/kotlin/androidx/compose/ui/text/TextStyle?hl=ja&_gl=1*10zie6d*_up*MQ..*_ga*MTQ1NzI0ODE0NC4xNzI2NzI4Nzk2*_ga_6HH9YJMN9M*MTcyNjcyODc5Ni4xLjAuMTcyNjcyODc5Ni4wLjAuNzY3NTIxMjY2) ã€ [DrawScope](https://developer.android.com/reference/kotlin/androidx/compose/ui/graphics/drawscope/DrawScope?hl=ja&_gl=1*10zie6d*_up*MQ..*_ga*MTQ1NzI0ODE0NC4xNzI2NzI4Nzk2*_ga_6HH9YJMN9M*MTcyNjcyODc5Ni4xLjAuMTcyNjcyODc5Ni4wLjAuNzY3NTIxMjY2) ã®æç”»å‘¼ã³å‡ºã—ã§ä½¿ç”¨å¯èƒ½ã§ã€æç”»ã™ã‚‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã«ãƒšã‚¤ãƒ³ãƒˆ ã‚¹ã‚¿ã‚¤ãƒ«ã‚’é©ç”¨ã§ãã¾ã™ã€‚

ãŸã¨ãˆã°ã€æ°´å¹³ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ ãƒ–ãƒ©ã‚·ã‚’ DrawScope ã®å††ã«é©ç”¨ã§ãã¾ã™ã€‚

```kotlin
val brush = Brush.horizontalGradient(listOf(Color.Red, Color.Blue))
Canvas(
    modifier = Modifier.size(200.dp),
    onDraw = {
        drawCircle(brush)
    }
)
```

<img src="./ç”»åƒ/æ°´å¹³ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã§æç”»ã•ã‚ŒãŸå††.png" width="200">


## ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ–ãƒ©ã‚·

ã•ã¾ã–ã¾ãªçµ„ã¿è¾¼ã¿ã®ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ ãƒ–ãƒ©ã‚·ã‚’ä½¿ç”¨ã—ã¦ã€å¤šæ§˜ãªã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³åŠ¹æœã‚’é©ç”¨ã§ãã¾ã™ã€‚ã“ã‚Œã‚‰ã®ãƒ–ãƒ©ã‚·ã§ã¯ã€ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã®ç”Ÿæˆã§ä½¿ç”¨ã™ã‚‹è‰²ã®ãƒªã‚¹ãƒˆã‚’æŒ‡å®šã§ãã¾ã™ã€‚

ä»¥ä¸‹ã«ã€ä½¿ç”¨å¯èƒ½ãªã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ–ãƒ©ã‚·ã®ä¸€è¦§ã‚’ç¤ºã—ã¾ã™ã€‚

- [Brush.horizontalGradient(colorList)](https://developer.android.com/reference/kotlin/androidx/compose/ui/graphics/Brush?hl=ja&_gl=1*1mfiy6l*_up*MQ..*_ga*MTQ1NzI0ODE0NC4xNzI2NzI4Nzk2*_ga_6HH9YJMN9M*MTcyNjcyODc5Ni4xLjAuMTcyNjcyODc5Ni4wLjAuNzY3NTIxMjY2#horizontalGradient(kotlin.collections.List,kotlin.Float,kotlin.Float,androidx.compose.ui.graphics.TileMode))

<img src="./ç”»åƒ/Brush.horizontalGradient(colorList).png" width="100">


- [Brush.linearGradient(colorList)](https://developer.android.com/reference/kotlin/androidx/compose/ui/graphics/Brush?hl=ja&_gl=1*1mfiy6l*_up*MQ..*_ga*MTQ1NzI0ODE0NC4xNzI2NzI4Nzk2*_ga_6HH9YJMN9M*MTcyNjcyODc5Ni4xLjAuMTcyNjcyODc5Ni4wLjAuNzY3NTIxMjY2#linearGradient(kotlin.Array,androidx.compose.ui.geometry.Offset,androidx.compose.ui.geometry.Offset,androidx.compose.ui.graphics.TileMode))

<img src="./ç”»åƒ/Brush.linearGradient(colorList).png" width="100">


- [Brush.verticalGradient(colorList)](https://developer.android.com/reference/kotlin/androidx/compose/ui/graphics/Brush?hl=ja&_gl=1*1mfiy6l*_up*MQ..*_ga*MTQ1NzI0ODE0NC4xNzI2NzI4Nzk2*_ga_6HH9YJMN9M*MTcyNjcyODc5Ni4xLjAuMTcyNjcyODc5Ni4wLjAuNzY3NTIxMjY2#verticalGradient(kotlin.collections.List,kotlin.Float,kotlin.Float,androidx.compose.ui.graphics.TileMode))

<img src="./ç”»åƒ/Brush.verticalGradient(colorList).png" width="100">


- [Brush.sweepGradient(colorList)](https://developer.android.com/reference/kotlin/androidx/compose/ui/graphics/Brush?hl=ja&_gl=1*1mfiy6l*_up*MQ..*_ga*MTQ1NzI0ODE0NC4xNzI2NzI4Nzk2*_ga_6HH9YJMN9M*MTcyNjcyODc5Ni4xLjAuMTcyNjcyODc5Ni4wLjAuNzY3NTIxMjY2#sweepGradient(kotlin.Array,androidx.compose.ui.geometry.Offset))

<img src="./ç”»åƒ/Brush.sweepGradient(colorList).png" width="100">

æ³¨: è‰²ãŒæ»‘ã‚‰ã‹ã«ç§»ã‚Šå¤‰ã‚ã‚‹ã‚ˆã†ã«ã€ãŸã„ã¦ã„ã®å ´åˆã¯ã€æœ€å¾Œã®è‰²ã‚’æœ€åˆã¨åŒã˜è‰²ã«è¨­å®šã™ã‚‹ã®ãŒè‰¯ã„ã§ã™ã€‚


- [Brush.radialGradient(colorList)](https://developer.android.com/reference/kotlin/androidx/compose/ui/graphics/Brush?hl=ja&_gl=1*1mfiy6l*_up*MQ..*_ga*MTQ1NzI0ODE0NC4xNzI2NzI4Nzk2*_ga_6HH9YJMN9M*MTcyNjcyODc5Ni4xLjAuMTcyNjcyODc5Ni4wLjAuNzY3NTIxMjY2#radialGradient(kotlin.Array,androidx.compose.ui.geometry.Offset,kotlin.Float,androidx.compose.ui.graphics.TileMode))

<img src="./ç”»åƒ/Brush.radialGradient(colorList).png" width="100">


### colorStops ã§è‰²ã®åˆ†å¸ƒã‚’å¤‰æ›´ã™ã‚‹

ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚ã‚‰ã‚ã‚Œã‚‹è‰²ã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã™ã‚‹ã«ã¯ã€ãã‚Œãã‚Œã®è‰²ã® colorStops å€¤ã‚’èª¿æ•´ã—ã¾ã™ã€‚colorStops ã¯ 0 ã‹ã‚‰ 1 ã®å‰²åˆã§æŒ‡å®šã—ã¾ã™ã€‚ã“ã‚Œã¯ã€é–‹å§‹åœ°ç‚¹ã®è‰²ã‚’ 0 ã¨ã—ã¦ã€çµ‚äº†åœ°ç‚¹ã®è‰²ã‚’ 1 ã«ã—ã¦ã€ãã®é€²æ—ç‡ã«å¿œã˜ã¦ã€é–“ã®è‰²ã®å€¤ã‚’è¨­å®šã—ã¾ã™ã€‚ 1 ã‚ˆã‚Šå¤§ãã„å€¤ã‚’æŒ‡å®šã™ã‚‹ã¨ã€ãã®è‰²ã¯ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã®ä¸­ã§ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚Œãªããªã‚Šã¾ã™ã€‚

ã‚ã‚‹è‰²ã®é‡ã‚’å°ã•ãã—ãŸã‚Šã€ã‚ã‚‹ã„ã¯å¤§ããã—ãŸã‚Šãªã©ã€ç•°ãªã‚‹é‡ã«ãªã‚‹ã‚ˆã†ã«ã‚«ãƒ©ãƒ¼ã‚¹ãƒˆãƒƒãƒ—ã‚’æ§‹æˆã§ãã¾ã™ã€‚

```kotlin
val colorStops = arrayOf(
    0.0f to Color.Yellow,
    0.2f to Color.Red,
    1f to Color.Blue
)
Box(
    modifier = Modifier
        .requiredSize(200.dp)
        .background(Brush.horizontalGradient(colorStops = colorStops))
)
```

è‰²ã¯ã€colorStop ãƒšã‚¢ã§å®šç¾©ã•ã‚Œã‚‹æŒ‡å®šã•ã‚ŒãŸã‚ªãƒ•ã‚»ãƒƒãƒˆã§åˆ†æ•£ã•ã‚Œã€èµ¤ã¨é’ã‚ˆã‚Šã‚‚é»„è‰²ãŒå°‘ãªããªã‚Šã¾ã™ã€‚

<img src="./ç”»åƒ/ã‚«ãƒ©ãƒ¼ã‚¹ãƒˆãƒƒãƒ—ãŒè¨­å®šã•ã‚ŒãŸãƒ–ãƒ©ã‚·.png" width="200">


### TileMode ã§ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ç¹°ã‚Šè¿”ã™

å„ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ ãƒ–ãƒ©ã‚·ã«ã¯ã€ [TileMode](https://developer.android.com/reference/kotlin/androidx/compose/ui/graphics/TileMode?hl=ja&_gl=1*a64dma*_up*MQ..*_ga*MTQ1NzI0ODE0NC4xNzI2NzI4Nzk2*_ga_6HH9YJMN9M*MTcyNjcyODc5Ni4xLjAuMTcyNjcyODc5Ni4wLjAuNzY3NTIxMjY2) ã‚’è¨­å®šã™ã‚‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒã‚ã‚Šã¾ã™ã€‚ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã®é–‹å§‹ã¨çµ‚äº†ã‚’è¨­å®šã—ã¦ã„ãªã„å ´åˆã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§é ˜åŸŸå…¨ä½“ãŒå¡—ã‚Šã¤ã¶ã•ã‚Œã‚‹ãŸã‚ã€TileMode ã«æ°—ã¥ã‹ãªã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚TileMode ã¯ã€é ˜åŸŸã®ã‚µã‚¤ã‚ºãŒãƒ–ãƒ©ã‚·ã®ã‚µã‚¤ã‚ºã‚ˆã‚Šå¤§ãã„å ´åˆã«ã®ã¿ã€ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã‚¿ã‚¤ãƒ«åŒ–ã—ã¾ã™ã€‚

æ¬¡ã®ã‚³ãƒ¼ãƒ‰ã®å ´åˆã€endX ãŒ 50.dp ã«è¨­å®šã•ã‚Œã€ã‚µã‚¤ã‚ºãŒ 200.dp ã«è¨­å®šã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒ 4 å›ç¹°ã‚Šè¿”ã•ã‚Œã¾ã™ã€‚

```kotlin
val listColors = listOf(Color.Yellow, Color.Red, Color.Blue)
val tileSize = with(LocalDensity.current) {
    50.dp.toPx()
}
Box(
    modifier = Modifier
        .requiredSize(200.dp)
        .background(
            Brush.horizontalGradient(
                listColors,
                endX = tileSize,
                tileMode = TileMode.Repeated
            )
        )
)
```

ä»¥ä¸‹ã®è¡¨ã¯ã€ç•°ãªã‚‹ TileMode ãŒä¸Šè¨˜ã® HorizontalGradient ã®ä¾‹ã®å ´åˆã§ã©ã®ã‚ˆã†ã«æ©Ÿèƒ½ã™ã‚‹ã‹ã‚’èª¬æ˜ã—ã¦ã„ã¾ã™ã€‚

- [TileMode.Repeated](https://developer.android.com/reference/kotlin/androidx/compose/ui/graphics/TileMode?hl=ja&_gl=1*1290w7q*_up*MQ..*_ga*MTQ1NzI0ODE0NC4xNzI2NzI4Nzk2*_ga_6HH9YJMN9M*MTcyNjcyODc5Ni4xLjAuMTcyNjcyODc5Ni4wLjAuNzY3NTIxMjY2#Repeated())

æœ€å¾Œã®è‰²ã‹ã‚‰æœ€åˆã®è‰²ã¾ã§ã‚¨ãƒƒã‚¸ãŒç¹°ã‚Šè¿”ã•ã‚Œã¾ã™ã€‚

<img src="./ç”»åƒ/TileMode.Repeated.png" width="100">


- [TileMode.Mirror](https://developer.android.com/reference/kotlin/androidx/compose/ui/graphics/TileMode?hl=ja&_gl=1*8plxa0*_up*MQ..*_ga*MTQ1NzI0ODE0NC4xNzI2NzI4Nzk2*_ga_6HH9YJMN9M*MTcyNjcyODc5Ni4xLjAuMTcyNjcyODc5Ni4wLjAuNzY3NTIxMjY2#Mirror())

ã‚¨ãƒƒã‚¸ã§åè»¢ã—ã¦ã€æœ€å¾Œã®è‰²ã‹ã‚‰æœ€åˆã®è‰²ã®é †ã§è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

<img src="./ç”»åƒ/TileMode.Mirror.png" width="100">


- [TileMode.Clamp](https://developer.android.com/reference/kotlin/androidx/compose/ui/graphics/TileMode?hl=ja&_gl=1*8plxa0*_up*MQ..*_ga*MTQ1NzI0ODE0NC4xNzI2NzI4Nzk2*_ga_6HH9YJMN9M*MTcyNjcyODc5Ni4xLjAuMTcyNjcyODc5Ni4wLjAuNzY3NTIxMjY2#Clamp())

ã‚¨ãƒƒã‚¸ã§æœ€å¾Œã®è‰²ã«å›ºå®šã•ã‚Œã¾ã™ã€‚ãã‚Œä»¥é™ã®é ˜åŸŸã¯ã€ãã®è‰²ã«æœ€ã‚‚è¿‘ã„è‰²ã§å¡—ã‚Šã¤ã¶ã•ã‚Œã¾ã™ã€‚

<img src="./ç”»åƒ/TileMode.Clamp.png" width="100">


- [TileMode.Decal](https://developer.android.com/reference/kotlin/androidx/compose/ui/graphics/TileMode?hl=ja&_gl=1*8plxa0*_up*MQ..*_ga*MTQ1NzI0ODE0NC4xNzI2NzI4Nzk2*_ga_6HH9YJMN9M*MTcyNjcyODc5Ni4xLjAuMTcyNjcyODc5Ni4wLjAuNzY3NTIxMjY2#Decal())

å¢ƒç•Œã®ã‚µã‚¤ã‚ºã¾ã§ã®ã¿ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚Œã¾ã™ã€‚TileMode.Decal ã§ã¯ã€é€æ˜ãªé»’ã‚’åˆ©ç”¨ã—ã¦å…ƒã®å¢ƒç•Œã®å¤–å´ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã•ã‚Œã¾ã™ãŒã€TileMode.Clamp ã§ã¯ã‚¨ãƒƒã‚¸ã®è‰²ãŒã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã•ã‚Œã¾ã™ã€‚

<img src="./ç”»åƒ/TileMode.Decal.png" width="100">

æ³¨: TileMode.Decal ã¯ API 31 ä»¥é™ã§ã®ã¿ä½¿ç”¨ã§ãã¾ã™ã€‚TileMode.isSupported() ã‚’ä½¿ç”¨ã—ã¦ã€TileMode ãŒãƒ‡ãƒã‚¤ã‚¹ã§ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã—ã¾ã™ã€‚ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ãªã„ TileMode ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã® TileMode.Clamp ãŒé©ç”¨ã•ã‚Œã¾ã™ã€‚
TileMode ã¯ã€ä»–ã®æ–¹å‘æ€§ã®ã‚ã‚‹ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã§ã‚‚åŒæ§˜ã«æ©Ÿèƒ½ã—ã¾ã™ã€‚é•ã„ã¯åå¾©ãŒç™ºç”Ÿã™ã‚‹æ–¹å‘ã§ã™ã€‚


### ãƒ–ãƒ©ã‚·ã‚µã‚¤ã‚ºã‚’å¤‰æ›´ã™ã‚‹

ãƒ–ãƒ©ã‚·ã‚’é©ç”¨ã™ã‚‹é ˜åŸŸã®ã‚µã‚¤ã‚ºãŒã‚ã‹ã£ã¦ã„ã‚‹å ´åˆã¯ã€ä¸Šè¨˜ã® TileMode ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§èª¬æ˜ã—ãŸã‚ˆã†ã«ã€ã‚¿ã‚¤ãƒ« endX ã‚’è¨­å®šã§ãã¾ã™ã€‚DrawScope ã‚’é–‹ã„ã¦ã„ã‚‹å ´åˆã¯ã€ [size](https://developer.android.com/reference/kotlin/androidx/compose/ui/graphics/drawscope/DrawScope?hl=ja&_gl=1*3ijzhd*_up*MQ..*_ga*MTQ1NzI0ODE0NC4xNzI2NzI4Nzk2*_ga_6HH9YJMN9M*MTcyNjcyODc5Ni4xLjAuMTcyNjcyODc5Ni4wLjAuNzY3NTIxMjY2#size()) ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’ä½¿ç”¨ã—ã¦é ˜åŸŸã®ã‚µã‚¤ã‚ºã‚’å–å¾—ã§ãã¾ã™ã€‚

æç”»ã™ã‚‹é ˜åŸŸã®ã‚µã‚¤ã‚ºãŒä¸æ˜ãªå ´åˆï¼ˆãŸã¨ãˆã°ã€Brush ãŒãƒ†ã‚­ã‚¹ãƒˆã«é©ç”¨ã•ã‚Œã‚‹å ´åˆï¼‰ã€Shader ã‚’æ‹¡å¼µã—ã¦ã€createShader é–¢æ•°ã§æç”»é ˜åŸŸã®ã‚µã‚¤ã‚ºã‚’åˆ©ç”¨ã§ãã¾ã™ã€‚

å‚è€ƒ : Shader ã¨ã¯ã€ä¸€èˆ¬çš„ã«ã€ç”»é¢ã«è¡¨ç¤ºã™ã‚‹ã‚‚ã®ã‚’è¨ˆç®—ã—ã¦ãã‚Œã‚‹å‡¦ç†ã®ã“ã¨ã‚’ç¤ºã—ã¾ã™ã€‚

ã“ã®ä¾‹ã§ã¯ã€ã‚µã‚¤ã‚ºã‚’ 4 åˆ†ã® 1 ã«ã—ã¦ã€ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ 4 å›ç¹°ã‚Šè¿”ã—ã¾ã™ã€‚

```kotlin
val listColors = listOf(Color.Yellow, Color.Red, Color.Blue)
val customBrush = remember {
    object : ShaderBrush() {
        override fun createShader(size: Size): Shader {
            return LinearGradientShader(
                colors = listColors,
                // from ã¨ to ã¯ã€ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿæ–½ã™ã‚‹å‘ã (ãƒ™ã‚¯ãƒˆãƒ«) ã‚’ç¤ºã™ã€‚
                from = Offset.Zero,
                to = Offset(size.width / 4f, 0f),
                tileMode = TileMode.Mirror
            )
        }
    }
}
Box(
    modifier = Modifier
        .requiredSize(200.dp)
        .background(customBrush)
)
```

ã“ã®å®Ÿè£…æ–¹æ³•ã§ã¯ã€å…ˆã»ã©ã®ãƒ–ãƒ©ã‚·ã®å¹…ã‚’å›ºå®šé•· ( 50 dp ) ã«ã—ã¦ã„ãŸã®ã¨ã¯ç•°ãªã‚Šã€è¦ªã®ã‚µã‚¤ã‚ºã«åˆã‚ã›ã¦ã€å‹•çš„ã«ãƒ–ãƒ©ã‚·ã®ã‚µã‚¤ã‚ºã‚’æ±ºå®šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

<img src="./ç”»åƒ/ShaderBrush ã®ä½¿ç”¨ä¾‹.png" width="150">

å††å½¢ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãªã©ã€ä»–ã®ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ ãƒ–ãƒ©ã‚·ã®ã‚µã‚¤ã‚ºã‚’å¤‰æ›´ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚ã‚µã‚¤ã‚ºã¨ä¸­å¿ƒã‚’æŒ‡å®šã—ãªã„å ´åˆã€ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã¯ DrawScope ã®å…¨é ˜åŸŸã‚’å¡—ã‚Šã¤ã¶ã—ã¾ã™ã€‚ã¾ãŸã€å††å½¢ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã®ä¸­å¿ƒã¯ DrawScope é ˜åŸŸã®ä¸­å¿ƒã«ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§è¨­å®šã•ã‚Œã¾ã™ã€‚ã“ã®å ´åˆã€å††å½¢ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã®ä¸­å¿ƒãŒã€å¹…ã¨é«˜ã•ã®ã†ã¡å°ã•ã„ã»ã†ã®ä¸­å¿ƒã¨ã—ã¦è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

```kotlin
Box(
    modifier = Modifier
        .fillMaxSize()
        .background(
            Brush.radialGradient(
                listOf(Color(0xFF2be4dc), Color(0xFF243484))
            )
        )
)
```

<img src="./ç”»åƒ/ã‚µã‚¤ã‚ºã‚’æŒ‡å®šã—ã¦ã„ãªã„å††å½¢ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³.png" width="150">

åŠå¾„ã‚µã‚¤ã‚ºã‚’æœ€å¤§ã«è¨­å®šã™ã‚‹ã‚ˆã†ã«å††å½¢ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãŒå¤‰æ›´ã•ã‚Œã‚‹ã¨ã€æ¬¡ã®ã‚ˆã†ã«ã€å††å½¢ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã®åŠ¹æœãŒæ”¹å–„ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚

```kotlin
val largeRadialGradient = object : ShaderBrush() {
    override fun createShader(size: Size): Shader {
        val biggerDimension = maxOf(size.height, size.width)
        return RadialGradientShader(
            colors = listOf(Color(0xFF2be4dc), Color(0xFF243484)),
            center = size.center,
            radius = biggerDimension / 2f,
            colorStops = listOf(0f, 0.95f)
        )
    }
}

Box(
    modifier = Modifier
        .fillMaxSize()
        .background(largeRadialGradient)
)
```

<img src="./ç”»åƒ/ã‚ˆã‚Šå¤§ããªåŠå¾„ã®å††å½¢ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³.png" width="150">

ã‚·ã‚§ãƒ¼ãƒ€ãƒ¼ã®ä½œæˆã«æ¸¡ã•ã‚Œã‚‹å®Ÿéš›ã®ã‚µã‚¤ã‚ºã¯ã€å‘¼ã³å‡ºã•ã‚ŒãŸå ´æ‰€ã‹ã‚‰æ±ºå®šã•ã‚Œã‚‹ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã€ã‚µã‚¤ã‚ºãŒ Brush ã®æœ€å¾Œã®ä½œæˆã¨ç•°ãªã‚‹å ´åˆã€ã¾ãŸã¯ã€ã‚·ã‚§ãƒ¼ãƒ€ãƒ¼ã®ä½œæˆã«ä½¿ç”¨ã•ã‚ŒãŸçŠ¶æ…‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒå¤‰æ›´ã•ã‚ŒãŸå ´åˆã€Brush ãŒãã® Shader ã‚’å†…éƒ¨ã§å†å‰²ã‚Šå½“ã¦ã—ã¾ã™ã€‚

æ¬¡ã®ã‚³ãƒ¼ãƒ‰ã¯ã€æç”»é ˜åŸŸã®ã‚µã‚¤ã‚ºã®å¤‰åŒ–ã«å¿œã˜ã¦ã€ã‚·ã‚§ãƒ¼ãƒ€ãƒ¼ã‚’ç•°ãªã‚‹ã‚µã‚¤ã‚ºã§ 3 å›ä½œæˆã—ã¾ã™ã€‚

```kotlin
val colorStops = arrayOf(
    0.0f to Color.Yellow,
    0.2f to Color.Red,
    1f to Color.Blue
)
val brush = Brush.horizontalGradient(colorStops = colorStops)
Box(
    modifier = Modifier
        .requiredSize(200.dp)
        .drawBehind {
            drawRect(brush = brush) // will allocate a shader to occupy the 200 x 200 dp drawing area
            inset(50f) {
      /* Will allocate a shader to occupy the 180 x 180 dp drawing area as the
       inset scope reduces the drawing  area by 10 pixels on the left, top, right,
      bottom sides */
                drawRect(brush = brush)
                inset(100f) {
        /* will allocate a shader to occupy the 170 x 170 dp drawing area as the
         inset scope reduces the  drawing area by 5 pixels on the left, top,
         right, bottom sides */
                    drawRect(brush = brush)
                }
            }
        }
)
```

<img src="./ç”»åƒ/ã‚·ã‚§ãƒ¼ãƒ€ãƒ¼ã‚’ç•°ãªã‚‹ã‚µã‚¤ã‚ºã§ 3 å›ä½œæˆ.png" width="150">


## ç”»åƒã‚’ãƒ–ãƒ©ã‚·ã¨ã—ã¦ä½¿ç”¨ã™ã‚‹

ImageBitmap ã‚’ Brush ã¨ã—ã¦ä½¿ç”¨ã™ã‚‹ã«ã¯ã€ç”»åƒã‚’ ImageBitmap ã¨ã—ã¦èª­ã¿è¾¼ã¿ã€ImageShader ãƒ–ãƒ©ã‚·ã‚’ä½œæˆã—ã¾ã™ã€‚

```kotlin
val imageBrush =
    ShaderBrush(ImageShader(ImageBitmap.imageResource(id = R.drawable.dog)))

// ImageShader ãƒ–ãƒ©ã‚·ã‚’ background ã¨ä¸€ç·’ã«ä½¿ç”¨ã™ã‚‹ã€‚
Box(
    modifier = Modifier
        .requiredSize(200.dp)
        .background(imageBrush)
)

// ImageShader ãƒ–ãƒ©ã‚·ã‚’ TextStyle ã¨ä¸€ç·’ã«ä½¿ç”¨ã™ã‚‹ã€‚
Text(
    text = "Hello Android!",
    style = TextStyle(
        brush = imageBrush,
        fontWeight = FontWeight.ExtraBold,
        fontSize = 36.sp
    )
)

// ImageShader ãƒ–ãƒ©ã‚·ã‚’ DrawScope#drawCircle() ã¨ä¸€ç·’ã«ä½¿ç”¨ã™ã‚‹ã€‚
Canvas(onDraw = {
    drawCircle(imageBrush)
}, modifier = Modifier.size(200.dp))
```

ãƒ–ãƒ©ã‚·ãŒã€èƒŒæ™¯ã€ãƒ†ã‚­ã‚¹ãƒˆã€ã‚­ãƒ£ãƒ³ãƒã‚¹ãªã©ã€ç•°ãªã‚‹è¤‡æ•°ã®æç”»ã«é©ç”¨ã•ã‚Œã¾ã™ã€‚å‡ºåŠ›ã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

<img src="./ç”»åƒ/ImageShader ãƒ–ãƒ©ã‚·ã‚’ä½¿ç”¨ã—ã¦èƒŒæ™¯ã€ãƒ†ã‚­ã‚¹ãƒˆã€å††ã‚’æç”»ã™ã‚‹.png" width="500">


## é«˜åº¦ãªä¾‹: ã‚«ã‚¹ã‚¿ãƒ ãƒ–ãƒ©ã‚·

### AGSL ã® RuntimeShader ãƒ–ãƒ©ã‚·

[AGSL](https://developer.android.com/develop/ui/views/graphics/agsl?hl=ja&_gl=1*16jp4oy*_up*MQ..*_ga*MTQ1NzI0ODE0NC4xNzI2NzI4Nzk2*_ga_6HH9YJMN9M*MTcyNjcyODc5Ni4xLjAuMTcyNjcyODc5Ni4wLjAuNzY3NTIxMjY2) ã§ã¯ã€ [GLSL](https://developer.android.com/develop/ui/views/graphics/agsl/agsl-vs-glsl?hl=ja&_gl=1*16jp4oy*_up*MQ..*_ga*MTQ1NzI0ODE0NC4xNzI2NzI4Nzk2*_ga_6HH9YJMN9M*MTcyNjcyODc5Ni4xLjAuMTcyNjcyODc5Ni4wLjAuNzY3NTIxMjY2) Shader æ©Ÿèƒ½ãŒä¸€éƒ¨æä¾›ã•ã‚Œã¦ã„ã¾ã™ã€‚Shader ã‚’ AGSL ã§è¨˜è¿°ã—ã¦ã€Compose ã®ãƒ–ãƒ©ã‚·ã§ä½¿ç”¨ã§ãã¾ã™ã€‚

Shader ãƒ–ãƒ©ã‚·ã‚’ä½œæˆã™ã‚‹ã«ã¯ã€ã¾ãš AGSL ã‚·ã‚§ãƒ¼ãƒ€ãƒ¼æ–‡å­—åˆ—ã¨ã—ã¦ Shader ã‚’å®šç¾©ã—ã¾ã™ã€‚

```kotlin
@Language("AGSL")
val CUSTOM_SHADER = """
    uniform float2 resolution;
    layout(color) uniform half4 color;
    layout(color) uniform half4 color2;

    half4 main(in float2 fragCoord) {
        float2 uv = fragCoord/resolution.xy;

        float mixValue = distance(uv, vec2(0, 1));
        return mix(color, color2, mixValue);
    }
""".trimIndent()
```

ä¸Šã®ã‚·ã‚§ãƒ¼ãƒ€ãƒ¼ã¯ 2 ã¤ã®å…¥åŠ›è‰²ã‚’å—ã‘å–ã‚Šã€æç”»é ˜åŸŸã®å·¦ä¸‹ï¼ˆvec2(0, 1)ï¼‰ã‹ã‚‰ã®è·é›¢ã‚’è¨ˆç®—ã—ã¦ã€è·é›¢ã«åŸºã¥ã„ã¦ 2 ã¤ã®è‰²é–“ã§ mix ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³åŠ¹æœãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚

æ¬¡ã«ã€Shader ãƒ–ãƒ©ã‚·ã‚’ä½œæˆã—ã€resolution ã®ãƒ¦ãƒ‹ãƒ•ã‚©ãƒ¼ãƒ ã‚’è¨­å®šã—ã¾ã™ã€‚ã“ã‚Œã¯ã€æç”»é ˜åŸŸã®ã‚µã‚¤ã‚ºã¨ã€ã‚«ã‚¹ã‚¿ãƒ  ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã¸ã®å…¥åŠ›ã¨ã—ã¦ä½¿ç”¨ã™ã‚‹ color ã¨ color2 ã§ã™ã€‚

```kotlin
val Coral = Color(0xFFF3A397)
val LightYellow = Color(0xFFF8EE94)

@RequiresApi(Build.VERSION_CODES.TIRAMISU)
@Composable
@Preview
fun ShaderBrushExample() {
    Box(
        modifier = Modifier
            .drawWithCache {
                val shader = RuntimeShader(CUSTOM_SHADER)
                val shaderBrush = ShaderBrush(shader)
                shader.setFloatUniform("resolution", size.width, size.height)
                onDrawBehind {
                    shader.setColorUniform(
                        "color",
                        android.graphics.Color.valueOf(
                            LightYellow.red, LightYellow.green,
                            LightYellow
                                .blue,
                            LightYellow.alpha
                        )
                    )
                    shader.setColorUniform(
                        "color2",
                        android.graphics.Color.valueOf(
                            Coral.red,
                            Coral.green,
                            Coral.blue,
                            Coral.alpha
                        )
                    )
                    drawRect(shaderBrush)
                }
            }
            .fillMaxWidth()
            .height(200.dp)
    )
}
```

ã“ã‚Œã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€ç”»é¢ã«æ¬¡ã®ã‚‚ã®ãŒãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚Œã¾ã™ã€‚

<img src="./ç”»åƒ/Compose ã§å®Ÿè¡Œã•ã‚Œã‚‹ã‚«ã‚¹ã‚¿ãƒ  AGSL ã‚·ã‚§ãƒ¼ãƒ€ãƒ¼.png" width="400">

ãªãŠã€ã™ã¹ã¦æ•°å­¦ãƒ™ãƒ¼ã‚¹ã®è¨ˆç®—ã§ã‚ã‚‹ãŸã‚ã€ã‚·ã‚§ãƒ¼ãƒ€ãƒ¼ã§ã¯ã€å˜ãªã‚‹ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã ã‘ã§ãªãã€ã¯ã‚‹ã‹ã«å¤šãã®ã“ã¨ã‚’å®Ÿç¾ã§ãã¾ã™ã€‚AGSL ã®è©³ç´°ã«ã¤ã„ã¦ã¯ã€AGSL ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ã”è¦§ãã ã•ã„ã€‚

æ³¨: RuntimeShaders ã¯ Android 13 ä»¥é™ã§ã®ã¿å‹•ä½œã—ã¾ã™ã€‚ã‚³ãƒ³ãƒãƒ¼ã‚¶ãƒ–ãƒ«ã‚’ API if-else ãƒã‚§ãƒƒã‚¯ã§ãƒ©ãƒƒãƒ—ã—ã€é©åˆ‡ãªãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚’æä¾›ã—ã¾ã™ã€‚


## å‚è€ƒæƒ…å ±

Compose ã§ãƒ–ãƒ©ã‚·ã‚’ä½¿ç”¨ã™ã‚‹ãã®ä»–ã®ä¾‹ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒªã‚½ãƒ¼ã‚¹ã‚’ã”ç¢ºèªãã ã•ã„ã€‚

- [Compose ã§ãƒ–ãƒ©ã‚·ãƒ†ã‚­ã‚¹ãƒˆã®è‰²ã‚’ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã«ã™ã‚‹ ğŸ–Œï¸](https://medium.com/androiddevelopers/animating-brush-text-coloring-in-compose-%EF%B8%8F-26ae99d9b402)
- [Compose ã®ã‚«ã‚¹ã‚¿ãƒ  ã‚°ãƒ©ãƒ•ã‚£ãƒƒã‚¯ã¨ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ - Android Dev Summit 2022](https://youtu.be/xcfEQO0k_gU)
- [JetLagged ã‚µãƒ³ãƒ—ãƒ« - RuntimeShader ãƒ–ãƒ©ã‚·](https://github.com/android/compose-samples/blob/main/JetLagged/app/src/main/java/com/example/jetlagged/Background.kt)

