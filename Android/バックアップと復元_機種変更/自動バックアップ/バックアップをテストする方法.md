<!-- TOC START min:1 max:3 link:true asterisk:false update:true -->
- [バックアップをテストする方法](#バックアップをテストする方法)
  - [事前準備](#事前準備)
  - [バックアップをテストする](#バックアップをテストする)
  - [復元をテストする](#復元をテストする)
<!-- TOC END -->


# バックアップをテストする方法

## 事前準備

実機ではなく、エミュレーターを使用する場合は、 「バックアップと復元」 機能を有効にする必要があります。  
次のコマンドで有効にすることができます。

```
adb shell bmgr enabled
```


## バックアップをテストする

アプリのバックアップを開始するには、次のコマンドを実行します。
このコマンドは、 Android 7.0 以降を搭載したデバイスとエミュレータで使用できます。

```
adb shell bmgr backupnow <PACKAGE>
```

パッケージのマニフェスト宣言に応じて、 Key-Value バックアップまたは自動バックアップが実行されます。  
エラー等になった場合は、 Logcat で内容が確認できるそうです。


## 復元をテストする

バックアップを作成した端末と復元を実行する端末が同じで、かつ、ログインしてるアカウントが同じ場合は、アプリをアンインストール後、再インストールすることで復元処理が実行されます。

別端末で復元したい場合は、復元したい端末の初期設定ウィザード内で、対象のアプリデータをコピーすると、データが復元されます。別端末で復元する場合は、初期設定ウィザードでの復元を逃すと、後で復元することができなくなります。その場合でも復元したい場合には、別途、アプリが独自にバックアップと復元の機能を実装している必要があります。



