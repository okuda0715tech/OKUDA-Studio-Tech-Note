<!-- TOC START min:1 max:3 link:true asterisk:false update:true -->
- [解像度](#解像度)
	- [用語](#用語)
	- [密度非依存ピクセルを使用する](#密度非依存ピクセルを使用する)
	- [Androidアプリで使用できる長さの単位](#androidアプリで使用できる長さの単位)
	- [汎用スクリーン密度](#汎用スクリーン密度)
		- [汎用スクリーン密度とは](#汎用スクリーン密度とは)
		- [汎用スクリーン密度一覧](#汎用スクリーン密度一覧)
	- [dp（密度非依存ピクセル）とpx（ピクセル）の変換](#dp密度非依存ピクセルとpxピクセルの変換)
		- [方法１：dpi（実スクリーン密度）を使用した方法](#方法dpi実スクリーン密度を使用した方法)
		- [方法２：変換倍率を使用した方法](#方法変換倍率を使用した方法)
		- [方法３：](#方法)
	- [spとpxの変換](#spとpxの変換)
	- [dpとspの変換](#dpとspの変換)
	- [変換機能を実装したユーティリティークラス](#変換機能を実装したユーティリティークラス)
	- [各スクリーン密度に応じたビットマップの準備](#各スクリーン密度に応じたビットマップの準備)
	- [getResourcces().getDimension(R.dimen.xxx)ではxxxのサイズをpxに変換して返す](#getresourccesgetdimensionrdimenxxxではxxxのサイズをpxに変換して返す)
<!-- TOC END -->


# 解像度

## 用語

- インチ
  - スクリーンの対角線の長さを表すのに使われる。
  - 1インチ = 2.54センチメートル
- ピクセル(px) / 画素 / ドット
  - コンピュータで画像を表示する際に量子化(色を数値化)した画像の最小ドットのこと。
- アスペクト比
  - スクリーンの縦横比
- スクリーン密度 / ピクセル密度
  - 1インチ内のピクセル数
  - 単位 : dpi / ppi
    - dpi : dots per inch
    - ppi : pixel per inch


## 密度非依存ピクセルを使用する

Androidデバイスは、様々なスクリーンサイズとスクリーン密度を持っています。
そのため、Viewや画像のサイズをピクセルで指定してしまうと、低解像度スクリーンでは大きく表示され、高解像度スクリーンでは、小さく表示されてしまいます。
これを避けるために、アプリでは密度非依存ピクセルを使用することが推奨されます。


## Androidアプリで使用できる長さの単位

- dp(dip)
  - Density-independent Pixels(密度非依存ピクセル)の略。dipと略すこともある。xmlでは`dp`と記載する。
  - mdpi (160 dpi) を基準とし、mdpi のとき 1dp = 1px となる。
- sp
  - Scale-independent Pixels(スケール非依存ピクセル)の略。
  - 基本的にはdpと同じ。
  - ただし、ユーザーの設定したフォントサイズに影響を受けます。
  - 文字サイズ以外にspを使用してはいけません。その旨は公式ドキュメントにも記載あり。
    - 公式ドキュメントより ->`ただし、テキストサイズを定義するときは、代わりにスケーラブル ピクセル（sp）を単位として使用する必要があります（ただし、レイアウトサイズには sp を使用しないでください）。`https://developer.android.com/training/multiscreen/screendensities.html#TaskUseDP
  - ユーザーの設定した表示サイズの影響は受けるが、表示サイズの影響はdpも同じように受けるため、その際のspとdpの違いはない。
- px
  - ピクセル
- in
  - スクリーン上の実際の物理的な長さ
  - インチ（1 インチ = 2.54 センチメートル）
- mm
  - スクリーン上の実際の物理的な長さ
  - ミリメートル
- pt
  - スクリーン上の実際の物理的な長さ
  - ポイント（1 ポイント = 1/72 インチ）
  - 1 ポイント ≒ 0.35 ミリメートル
  - Microsoft Wordなどで文字サイズの指定に使われている`11.5`や`12`は、単位がポイントとなっている。


## 汎用スクリーン密度

### 汎用スクリーン密度とは

リソースの 拡大 / 縮小 は、長さの単位に [dp] や [sp] を指定することによって、自動的に行われます。  
しかし、 拡大 / 縮小 するだけでは物足りない場合があります。  
例えば、スクリーン密度の低い端末に高解像度の画像を使用すると、画像の調整に余計なリソースを消費してしまいます。  
それを避けるために、汎用スクリーン密度という分類を用意して、各デバイスの実スクリーン密度によって、  
使用するリソースを切り替えることができます。  

汎用スクリーン密度として主に使用する分類は以下の表を参照してください。

実スクリーン密度を汎用スクリーン密度に割り当てる基準は、実スクリーン密度より大きな汎用スクリーン密度のうち、一番小さい密度を割り当てます。


### 汎用スクリーン密度一覧

汎用スクリーン密度略称 | 汎用スクリーン密度 | dp値（参考値） | 変換倍率（参考値） | px値=dp値×変換倍率（参考値）
-----------------------|--------------------|----------------|--------------------|-----------------------------
ldpi                   | 120dpi             | 4dp            | 0.75               | 3px
mdpi                   | 160dpi             | 4dp            | 1.00               | 4px
hdpi                   | 240dpi             | 4dp            | 1.50               | 6px
xhdpi                  | 320dpi             | 4dp            | 2.00               | 8px
xxhdpi                 | 480dpi             | 4dp            | 3.00               | 12px
xxxhdpi                | 640dpi             | 4dp            | 4.00               | 16px
nodpi                  | 全密度共通         | 4dp            | 1.00               | 4px

`dp値` 、 `変換倍率` 、 `px値` を参考値とした理由は、これらの値は、実スクリーン密度が汎用スクリーン密度と同じ場合の値であるためです。  
実際には、実スクリーン密度と汎用スクリーン密度は異なる場合の方が多いです。  
例えば、実スクリーン密度が 440dpi であるデバイスの場合、変換倍率は、 2.75倍 となり、  
dp値が 4dp である場合、px値は 11px になります。  
このデバイス上では、dp値からpx値への変換には、常に 2.75倍 が使用されます。  
よって、あくまでも、汎用スクリーン密度とは、使用するリソースを切り替えるためだけのものであり、  
変換倍率はデバイスごとにさらに細かく分かれます。

上記の一覧でdp値を4dpとしたのは、倍率が全て0.25倍の倍数であるため、4×0.25=1となり、算出後のpx値が整数値となるためである。


## dp（密度非依存ピクセル）とpx（ピクセル）の変換

dpとpxの変換方法は、以下の３通りの方法があります。


### 方法１：dpi（実スクリーン密度）を使用した方法

`px = dp × (dpi ÷ 160)`

160は、pxとdpが１対１で変換できる汎用スクリーン密度である。

**汎用スクリーン密度の取得方法**

```Java
// 方法1-1
int dpi = getResources().getDisplayMetrics().densityDpi;
// 方法1-2
DisplayMetrics metrics = new DisplayMetrics();
getWindowManager().getDefaultDisplay().getMetrics(metrics);
int dpi = metrics.densityDpi;

// 方法２と同じように、実際に取得したdpiからpxを算出する時には小数以下の丸めが必要となる。
```


### 方法２：変換倍率を使用した方法

`px = dp × 変換倍率`

**変換倍率の取得方法**

```Java
// 単純な変換式
float density = getResources().getDisplayMetrics().density;
// densityが小数になる可能性があるため、整数に丸めて使用することになります。
// 「(int)」でキャストする場合、小数点以下は切り捨てになるため、
// 小数点以下を切り捨てしたい場合は
int px = (int)(dp * density);
// 小数点以下を四捨五入したい場合は
int px = (int)(dp * density + 0.5f);
// とします。
```


### 方法３：

```Java
float pixel = TypedValue.applyDimension(
				TypedValue.COMPLEX_UNIT_DIP,
				dp,
				getResources().getDisplayMetrics());
```


## spとpxの変換

**spからpxへの変換**

```Java
public float converSpToPx(float sp) {
    return sp * context.getResources().getDisplayMetrics().scaleDensity;
}
```

**pxからspへの変換**

```Java
public float converPxToSp(float px) {
    return px / context.getResources().getDisplayMetrics().scaleDensity;
}
```


## dpとspの変換

一旦、pxを経由して変換する。


## 変換機能を実装したユーティリティークラス

同フォルダ内の `変換クラスサンプル.md` を参照


## 各スクリーン密度に応じたビットマップの準備

各スクリーン密度で同じ品質のビットマップを表示するためには、各密度に応じたビットマップを準備する必要があります。

`汎用スクリーン密度一覧`で示した倍率に応じたビットマップを準備する必要があります。
つまり、6つの密度分類の間が 3:4:6:8:12:16 のスケーリング比になるようにします。
例えば、以下のようなピクセルのビットマップを準備します。

- 低密度（ldpi）: 36x36（0.75 倍）
- 中密度（mdpi）: 48x48（1.0 倍、基準）
- 高密度（hdpi）: 72x72（1.5 倍）
- 超高密度（xhdpi）: 96x96（2.0 倍）
- 超超高密度（xxhdpi）: 144x144（3.0 倍）
- 超超超高密度（xxxhdpi）: 192x192（4.0 倍）

生成した画像ファイルを `res/` の適切なサブディレクトリに置くと、アプリが実行されているデバイスのスクリーン密度に基づいて正しいファイルが自動的に選択されます。

（例）

```
res/
  drawable-xxxhdpi/image.png
  drawable-xxhdpi/image.png
  drawable-xhdpi/image.png
  drawable-hdpi/image.png
  drawable-mdpi/image.png
  drawable-ldpi/image.png
もしくは、
res/
  drawable-nodpi/image.png
```

`@drawable/awesomeimage`を参照するとデバイスの実スクリーン密度に基づいて適切なビットマップが選択されます。  
デバイスの実スクリーン密度に最適な密度のビットマップが準備されていない場合は、次に適切なビットマップが選択されます。  
各スクリーン密度で共通のビットマップを使用したい場合には `drawable-nodpi` フォルダにリソースを配置します。  
`drawable-nodpi` フォルダとデフォルトの `drawable` フォルダの違いは今のところ不明です。


## getResourcces().getDimension(R.dimen.xxx)ではxxxのサイズをpxに変換して返す
