<!-- TOC START min:1 max:3 link:true asterisk:false update:true -->
- [処理のチェーン](#処理のチェーン)
  - [基本的なチェーンの実装サンプル](#基本的なチェーンの実装サンプル)
  - [WorkRequest の処理結果を後続の WorkRequest に渡す](#workrequest-の処理結果を後続の-workrequest-に渡す)
  - [並列処理した WorkRequest の処理結果を後続の WorkRequest に渡す](#並列処理した-workrequest-の処理結果を後続の-workrequest-に渡す)
  - [WorkContinuation に用意されていない API を使用したい場合](#workcontinuation-に用意されていない-api-を使用したい場合)
    - [概要](#概要)
    - [ワークチェーンを定期的に実行したい](#ワークチェーンを定期的に実行したい)
<!-- TOC END -->


# 処理のチェーン

## 基本的なチェーンの実装サンプル

チェーンを作成するには、以下のメソッドを使用します。

`WorkContinuation workManager.beginWith(OneTimeWorkRequest)`  
`WorkContinuation workManager.beginWith(List<OneTimeWorkRequest>)`  
`WorkContinuation workContinuation.then(OneTimeWorkRequest)`  
`WorkContinuation workContinuation.then(List<OneTimeWorkRequest>)`

`beginWith()` メソッドも `then()` メソッドも、引数に `List` 型を与える場合は、  
それらの `WorkRequest` は、平行実行可能な `WorkRequest` である必要があります。

```Java
WorkManager.getInstance(myContext)
  // 並行で実行可能な WorkRequest
  .beginWith(Arrays.asList(workReqest1, workReqest2, workReqest3))
  // 直前の全ての WorkRequest が完了したら開始される WorkRequest
  .then(insertWorkRequest)
  .then(uploadWorkRequest)
  // ワークチェーンを WorkManager に登録する
  .enqueue();
```


## WorkRequest の処理結果を後続の WorkRequest に渡す

Worker にインプットを渡したり、 Worker からアウトプットを渡す際に使用する `Data` クラスを使用すると思われる。


## 並列処理した WorkRequest の処理結果を後続の WorkRequest に渡す

並列処理した WorkRequest の処理結果は、マージすることで、後続の WorkRequest に渡すことができます。

デフォルトでは、以下の 2 種類のマージ方法が提供されています。

`OverwritingInputMerger`  
キー & バリュー形式でデータを渡します。  
キーに競合が発生すると、値は新しいもので上書きされます。

`ArrayCreatingInputMerger`  
キー & バリュー形式でデータを渡します。  
値は配列に格納されて渡されるため、キーに競合が発生しても、すべての値が保持されます。  
例：`key1:[val1, val2]`

上記以外のマージを行いたい場合には、上記のクラスの親クラスである `androidx.work.InputMerger`  
クラスを継承して独自のマージャーを作成します。


## WorkContinuation に用意されていない API を使用したい場合

### 概要

以下の項目のような `WorkContinuation` に用意されていない API を使用したい場合は、  
`WorkContinuation` をキューに登録するラッパーワーカーを作成し、そのラッパーワーカーを  
操作すれば、やりたいことを実現できる可能性があります。


### ワークチェーンを定期的に実行したい

概要欄を参照してください。
