<!-- TOC START min:1 max:3 link:true asterisk:false update:true -->
- [プロバイダからデータを取得する](#プロバイダからデータを取得する)
  - [概要](#概要)
  - [SQLのSELECT文とコンテンツプロバイダのquery()メソッドの対比](#sqlのselect文とコンテンツプロバイダのqueryメソッドの対比)
  - [サンプルコード](#サンプルコード)
<!-- TOC END -->


# プロバイダからデータを取得する

## 概要

コンテンツプロバイダからのデータ取得は、データベースのテーブルからSELECT文でデータを取得する  
感覚に似ています。

`ContentResolver.query()` メソッドを呼び出すことによって、 `ContentProvider.query()`  
メソッドが呼ばれます。


## SQLのSELECT文とコンテンツプロバイダのquery()メソッドの対比

SQLのSELECT文とコンテンツプロバイダの `query()` メソッドは以下のような対応になっています。

query() の引数 | SELECT キーワード / パラメータ                                                           | 備考
---------------|------------------------------------------------------------------------------------------|--------------------------------------------------------------------------
Uri            | FROM table_name                                                                          | Uri は、table_name という名前のプロバイダのテーブルにマッピングされます。
projection     | col,col,col,...                                                                          | projection は、取得する各行に含まれる列の配列です。
selection      | WHERE col = value                                                                        | selection は、行を選択する際の基準を指定します。
selectionArgs  | （完全に同等なものはありません。選択句では、? プレースホルダが選択引数に置き換わります） |
sortOrder      | ORDER BY col,col,...                                                                     | sortOrder は、返される Cursor で行が表示される順序を指定します。

`selection` と `selectionArgs` の両方を合わせて、SQLの `WHERE 列名 = "XXX"` に該当します。  
`query()` メソッドでWHERE句の部分を二つに分けているのは、SQLインジェクションを防止するためです。  
`selectionArgs` には、値しか許可されていません。ここに新しいSQL文を与えることはできません。


## サンプルコード

`ContentResolver` の `query()` メソッドを呼び出すことによって、 `ContentProvider` の  
`query()` メソッドが呼び出されます。

```java
// 既存の user dictionary プロバイダからデータを取得します。
cursor = getContentResolver().query(
    UserDictionary.Words.CONTENT_URI,  // コンテンツプロバイダーとその中にあるテーブルを指定します。
    projection,                        // データを取得する列を指定します。
    selection,                         // データを取得する行を指定します。
    selectionArgs,                     // Selection criteria
    sortOrder);                        // The sort order for the returned rows
```




