- [Mediator パターン](#mediator-パターン)
  - [役割](#役割)
  - [実装方法](#実装方法)
  - [使いどころ](#使いどころ)
    - [互いに関連しあう各 UI 要素を、一つの仲介役を通して状態を更新する。](#互いに関連しあう各-ui-要素を一つの仲介役を通して状態を更新する)


# Mediator パターン

## 役割

複数のクラスが互いに依存しあう局面で、仲介役オブジェクトを間に挟むことで、依存関係を最小限にします。

Facade パターンとは違い、 Facade パターンが一方向でメソッド呼び出しされるのに対して、 Mediator パターンは、各共同者からも仲介役のメソッドを呼び出します。

仲介役は、「イベントが集まるハブ」と考えることもできます。


## 実装方法

```kotlin
// Mediator
interface ChatMediator {
    fun sendMessage(message: String, targetUser: User)
}

// ConcreteMediator
class ChatRoom : ChatMediator {
    private val users = mutableListOf<User>()

    fun addUser(user: User) {
        users.add(user)
    }

    override fun sendMessage(message: String, targetUser: User) {
        users.filter { it != user }.forEach { it.receive(message) }
    }
}

// Colleague
abstract class User(protected val mediator: ChatMediator, val name: String) {
    abstract fun send(message: String)
    abstract fun receive(message: String)
}

// ConcreteColleague
class ConcreteUser(mediator: ChatMediator, name: String) : User(mediator, name) {
    override fun send(message: String) {
        println("$name sends: $message")
        mediator.sendMessage(message, ConcreteUser(mediator, "Takeshi"))
    }

    override fun receive(message: String) {
        println("$name received: $message")
    }
}
```


## 使いどころ

### 互いに関連しあう各 UI 要素を、一つの仲介役を通して状態を更新する。

省略


