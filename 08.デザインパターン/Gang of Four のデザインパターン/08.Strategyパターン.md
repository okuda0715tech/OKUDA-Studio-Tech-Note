- [Strategy パターン](#strategy-パターン)
  - [役割](#役割)
  - [実装方法](#実装方法)
  - [使いどころ](#使いどころ)
    - [ログイン方式の切り替え（例：Google, Twitter, メール）](#ログイン方式の切り替え例google-twitter-メール)
    - [モードの変更（表示モードと編集モードなど）](#モードの変更表示モードと編集モードなど)
    - [データ保存方式の切り替え](#データ保存方式の切り替え)
    - [テスト用モックに切り替える](#テスト用モックに切り替える)


# Strategy パターン

## 役割

動的にアルゴリズムを入れ替えるのに使用します。


## 実装方法

```kotlin
// Strategy：攻撃方法のインターフェース
interface AttackStrategy {
    fun attack()
}

// 具体的な戦略たち
class BowAttack : AttackStrategy {
    override fun attack() = println("弓で攻撃！")
}

class SwordAttack : AttackStrategy {
    override fun attack() = println("剣で攻撃！")
}

class MagicAttack : AttackStrategy {
    override fun attack() = println("魔法で攻撃！")
}

// Context：キャラクター
class Character(private var strategy: AttackStrategy) {
    fun performAttack() {
        strategy.attack()
    }

    fun changeStrategy(newStrategy: AttackStrategy) {
        strategy = newStrategy
    }
}
```

```kotli
// 使い方

val character = Character(SwordAttack())
character.performAttack() // → 剣で攻撃！

character.changeStrategy(MagicAttack())
character.performAttack() // → 魔法で攻撃！
```


## 使いどころ

### ログイン方式の切り替え（例：Google, Twitter, メール）

```kotlin
interface LoginStrategy {
    fun login()
}
```

### モードの変更（表示モードと編集モードなど）

```kotlin
sealed class UiMode {
    object Edit : UiMode()
    object View : UiMode()
}
```

```kotlin
interface ModeBehavior {
    fun onButtonClick()
}

class EditModeBehavior : ModeBehavior {
    override fun onButtonClick() {
        println("編集を保存")
    }
}

class ViewModeBehavior : ModeBehavior {
    override fun onButtonClick() {
        println("閲覧モード：編集開始へ切り替え")
    }
}
```

```kotlin
@Composable
fun MyScreen(mode: UiMode) {
    val behavior = remember(mode) {
        when (mode) {
            is UiMode.Edit -> EditModeBehavior()
            is UiMode.View -> ViewModeBehavior()
        }
    }

    Button(onClick = { behavior.onButtonClick() }) {
        Text("操作")
    }
}
```


### データ保存方式の切り替え

アプリによって「オンライン時はクラウド」「オフライン時はローカル」のような使い分けを実装できます。

```kotlin
interface StorageStrategy {
    fun save(data: String)
}

class LocalStorage : StorageStrategy
class RemoteStorage : StorageStrategy
```


### テスト用モックに切り替える

```kotlin
@Module
@InstallIn(SingletonComponent::class)
object StrategyModule {

    @Provides
    @Named("local")
    fun provideLocalStorageStrategy(): StorageStrategy = LocalStorageStrategy()

    @Provides
    @Named("cloud")
    fun provideCloudStorageStrategy(): StorageStrategy = CloudStorageStrategy()
}
```

上記の通り、 DI とも相性が良く、ストラテジーの切り替えを、 DI で実装することも可能です。




