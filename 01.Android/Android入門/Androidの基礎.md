- [Androidの基礎](#androidの基礎)
- [4 つの主要なアプリコンポーネント](#4-つの主要なアプリコンポーネント)
    - [アクティビティー](#アクティビティー)
    - [サービス](#サービス)
    - [コンテンツプロバイダー](#コンテンツプロバイダー)
    - [ブロードキャストレシーバー](#ブロードキャストレシーバー)
  - [Intentについて](#intentについて)
    - [アクティビティー、サービスの Intent について](#アクティビティーサービスの-intent-について)
    - [ブロードキャストレシーバーの Intent について](#ブロードキャストレシーバーの-intent-について)
    - [コンテンツプロバイダーの開始方法について](#コンテンツプロバイダーの開始方法について)
  - [AndroidManifest.xml への登録](#androidmanifestxml-への登録)


# Androidの基礎

# 4 つの主要なアプリコンポーネント

Androidには、 `Activity` 、 `Service` 、 `BroadcastReceiver` 、 `ContentsProvider` の4つの主要なコンポーネントがあります。  
コンポーネントという言葉自体は、「構成要素」という意味であるため、これら4つ以外のクラスについてもコンポーネントという呼び方をします。  
しかし、この4つは、特別なコンポーネントであり、アプリが生存し続けるために必要なコンポーネントです。  

アプリの生存期間は OS によって適切に管理されています。  
OS はアプリに「プロセス」と呼ばれるメモリ空間を用意して、その中でメモリを消費しながらアプリの処理を実行します。
プロセスの生存期間を管理するために、 Android OS は、上記の 4 つの主要なコンポーネントを用意しています。  
アプリユーザーによるアプリの操作やアプリ開発者による実装方法などによって、 4 つのコンポーネントは生存期間が管理されます。  
これらのコンポーネントが全て破棄された場合は、プロセスが存続する必要がないため、OSはプロセスも破棄します。

上記の登場人物をまとめると以下のような関連があります。

ユーザー or 開発者 or デバイスの状態 or ...など  
　↕  
主要な4つのコンポーネント  
　↕  
プロセス  
　↕  
OS


### アクティビティー

アクティビティは 1 つのユーザー インターフェースで 1 つの画面を表すものです。たとえば、メール アプリには新着メールの一覧を表示する 1 つのアクティビティと、メールを作成するアクティビティ、メールを閲覧するアクティビティがそれぞれ別にあります。 メールアプリでは、複数のアクティビティが一体となって結合したユーザー操作を実現しますが、それぞれは他のものから独立しています。 それにより、別のアプリで複数のアクティビティの中から、1 つのアクティビティを開始できるようになります（メールアプリが許可している場合）。 たとえば、カメラアプリでは写真を他のユーザーと共有するために、メール アプリの新規メールを作成するアクティビティを開始できます。


### サービス

サービスは、長期間の操作やリモート プロセスを処理するためにバックグラウンドで動作するコンポーネントです。 サービスは、ユーザー インターフェースを提供しません。 たとえば、サービスはユーザーが別のアプリを使用している間にバックグラウンドで音楽を再生したり、ユーザーが別のアクティビティを操作している間にそれを妨げることなくネットワークからデータを取得したりします。 アクティビティなどの別のコンポーネントは、サービスを開始して実行したり、それをバインドしたりして操作することもできます。


### コンテンツプロバイダー

コンテンツ プロバイダは、共有されているアプリデータを管理します。データは、ファイル システム、SQLite データベース、ウェブ、アプリがアクセスできる、あらゆる永続性のストレージに保存できます。 コンテンツ プロバイダを介して、他のアプリがデータをクエリしたり、修正したりすることもできます（コンテンツ プロバイダが許可している場合）。 たとえば、Android システムではユーザーの連絡先情報を管理するコンテンツ プロバイダを提供しています。 このように、適切なパーミッションさえあれば、アプリからコンテンツ プロバイダの一部（ContactsContract.Data など）に問い合わせて、特定の人物に関する情報を読み取ったり書き込んだりできます。
コンテンツ プロバイダは、アプリで非公開扱いの共有されていないデータを閲覧したり書き込んだりする場合にも役立ちます。 たとえば、Note Pad のサンプル アプリでは、コンテンツ プロバイダを使用してメモを保存します。

コンテンツ プロバイダは ContentProvider のサブクラスとして実装され、他のアプリがトランザクションを実行できるようにする API の標準セットを実装する必要があります。 詳細については、デベロッパー ガイドのコンテンツ プロバイダをご覧ください。


### ブロードキャストレシーバー

ブロードキャスト レシーバーは、システム全体のブロードキャスト アナウンスに応答するコンポーネントです。 たとえば、画面がオフになった、バッテリ残量が低い、写真が撮影されたなど、システムに起因するブロードキャストはたくさんあります。アプリでもブロードキャストを開始でき、たとえば他のアプリに、一部のデータが端末にダウンロードされ、利用可能になったことを伝えることもできます。 ブロードキャスト レシーバーがユーザー インターフェースを表示することはありませんが、ステータスバー通知を作成して、ブロードキャスト イベントの発生時にユーザーに警告できます。 一般的には、ブロードキャスト レシーバーは他のコンポーネントへの単なる「入り口」であり、最小限の操作を行うことが前提となっています。 たとえば、イベントに基づいた何らかの作業を実行するサービスを開始する場合などに適しています。
ブロードキャスト レシーバーは、BroadcastReceiver のサブクラスとして実装され、各ブロードキャストは Intent オブジェクトとして配信されます。 詳細については、BroadcastReceiver クラスをご覧ください。


## Intentについて

Intentは、アクティビティー、サービス、ブロードキャストレシーバーを起動するメッセンジャーのようなものです。
Intentを介すことで、自アプリ内のコンポーネントだけでなく、他アプリのコンポーネントを開始することもできます。
Intentは、コンポーネントを直接呼び出すのではなく、Android OSを介して、他のコンポーネントを呼び出します。これにより、他アプリのコンポーネント呼び出しが可能になっています。


### アクティビティー、サービスの Intent について

Intentには、実行するActionを定義したり、開始されたコンポーネントが知っておくべきデータのURIを含めることができます。
Actionには、Intentを受け取ったコンポーネントが実行するアクションを定義する。

場合によっては、結果を受け取るアクティビティを開始でき、この場合にアクティビティが返す結果も Intent になります（たとえば、ユーザーが個人の連絡先を取り出し、それを返してくれるインテントを発行できます。返されたインテントには選択された連絡先を指す URI が含まれています）。


### ブロードキャストレシーバーの Intent について

ブロードキャスト レシーバーの場合、インテントは単純にブロードキャストする内容を定義します（たとえば、端末のバッテリ残量が少ないことを示すブロードキャストには、「バッテリが少ない」ことを示す既知のアクション文字列が含まれます）。


### コンテンツプロバイダーの開始方法について

コンテンツプロバイダーはコンテンツリゾルバーから要求があった場合のみ、開始されます。
コンテンツリゾルバーには、データを操作するAPIを定義します。
コンテンツリゾルバーを介すことで、データが不正に操作されることを防いでいます。


## AndroidManifest.xml への登録

ソースに含まれていながら、マニフェスト ファイルでは定義されていないアクティビティ、サービス、コンテンツ プロバイダはシステムには見えないため、実行されることはありません。 ただし、ブロードキャスト レシーバーはマニフェストで宣言するか、コードで動的に作成（BroadcastReceiver オブジェクトとして）して registerReceiver() を呼び出すことでシステムに登録できます。

