<!-- TOC START min:1 max:3 link:true asterisk:false update:true -->
- [内部テスト](#内部テスト)
  - [アプリを PlayStore に公開する](#アプリを-playstore-に公開する)
  - [アプリを PlayStore からダウンロード & インストールする](#アプリを-playstore-からダウンロード--インストールする)
    - [テストに使用するデバイスで内部アプリ共有を ON にする (デバイスごとに初回のみ。アカウントごとではない)](#テストに使用するデバイスで内部アプリ共有を-on-にする-デバイスごとに初回のみアカウントごとではない)
    - [対象アプリの内部テストに招待してもらい、参加表明を行う（アプリごとに初回のみ）](#対象アプリの内部テストに招待してもらい参加表明を行うアプリごとに初回のみ)
    - [製品版、内部テスト版の切り替えについて](#製品版内部テスト版の切り替えについて)
<!-- TOC END -->


# 内部テスト

## 内部テストでできること

内部テスト版アプリをインストールすると、クラッシュや ANR が発生した場合に、 Google Play Console  
にて、該当部分のスタックトレースを確認することができるようになります。  
スタックトレースは、難読化を解除した状態で表示されます。

スタックトレースを確認するのに必要な準備は、 「運用・管理」 フォルダ内の  
「クラッシュ_ANRのレポート.md」 ドキュメントを確認してください。


## アプリを PlayStore に公開する

公開後 30 分程度で公開した旨のメールがディベロッパーアカウントのメールアドレスに来ます。  
公開自体は一瞬で終わる？がメールだけ 30 分程度かかっているように思われます。

内部テストに参加してもらうためには、 Google アカウントが必要です。  
内部テスト公開時に参加者として指定します。  
また、管理者がテスターを招待する必要があります。


## アプリを PlayStore からダウンロード & インストールする

### テストに使用するデバイスで内部アプリ共有を ON にする (デバイスごとに初回のみ。アカウントごとではない)

まずは、 PlayStore アプリの設定で、 `内部アプリ共有` を `ON` にする必要があります。  
`内部アプリ共有` ボタンは、デフォルトでは表示されていないため、以下の方法で表示させる必要があります。

```
Play Store アプリを開く -> 検索窓の右端のアカウントアイコン ->
設定 -> 概要 -> Play ストアのバージョン
```

表示された 「 Play ストアのバージョン」 を 7 回程度連続でタップします。  
上記の操作を行うと、以下の場所に 「内部アプリ共有」 が表示されます。

```
Play Store アプリを開く -> 検索窓の右端のアカウントアイコン ->
設定 -> 全般 -> 内部アプリ共有
```

「内部アプリ共有」 が表示されたら、スイッチを ON にします。


### 対象アプリの内部テストに招待してもらい、参加表明を行う（アプリごとに初回のみ）

アプリを PlayStore からダウンロードするためには、テストに招待してもらい、参加表明する必要があります。  
「招待」 とは、すなわち、参加表明ボタンの設置されている URL を該当のテスターに教えることを指します。  
テスターは、その 「参加する」 ボタンをタップすることでテスターとなることができます。

```
左側のメニュー -> リリース -> テスト -> 内部テスト ->
テスター数 タブ -> テストへの参加方法 -> ウェブで参加
```

のところにある `リンクをコピー` から取得します。

リンクをタップすると、テスト用 Google アカウントでのログインが求められます。  
ログインすると、内部テストに招待されている旨が表示されるため、参加ボタンを押します。  
既に同一テストアカウントで同一アプリのテストへ参加表明済みの場合は参加ボタンは表示されません。  
アプリのバージョンが上がっても、一度参加していれば、参加ボタンは表示されません。


### 製品版、内部テスト版の切り替えについて

Google による説明どおりの動作になっていないため、私の体験をもとに記載します。  
( Google による説明も参考のため、後半に記載します。)

```
【私の見解】
製品版、内部テスト版を切り替えるには、内部テストに参加しているかしていないかで決まります。
```

```
【Googleによる説明】
一度、一般公開済み (製品版) のアプリをインストールすると GooglePlay から  
内部テスト用のアプリがインストールできるようになります。
一般公開済みのアプリをインストールしたい場合は、内部テスト版のアプリをアンインストールすると、  
PlayStoreから一般公開済みのアプリをインストールできるようになります。
```

PlayStore で公開されるアプリの版が変更されるにはしばらく時間がかかることがあります。  
短い場合は、1分以内に反映されますが、長い場合は30分以上かかることも頻繁にあります。  
おそらく、 PlayStore アプリとサーバ側の両方にキャッシュを持っているようなので、  
**設定アプリから、 PlayStore アプリのキャッシュを削除すると、少し早く更新を入手できる可能性があります。**

**製品版と内部テスト版の見分け方**

PlayStoreで対象のアプリの詳細画面を表示すると、アプリ名に `アプリ名（内部用ベータ版）`  
と表示されているか、または、アプリ名のすぐ下に、  
`「このアプリは内部テスト版であり、不具合を含んでいる場合があります」` という旨の赤色文字が  
表示されていれば、内部テスト版です。いずれも表示されていなければ、製品版です。
