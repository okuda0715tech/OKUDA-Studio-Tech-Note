- [デスティネーション間の遷移をアニメーション化する](#デスティネーション間の遷移をアニメーション化する)
  - [Android View システムの場合](#android-view-システムの場合)
  - [Compose の場合](#compose-の場合)
    - [依存関係の追加](#依存関係の追加)
    - [AnimatedNavHost の使用](#animatednavhost-の使用)
    - [各パラメータの説明](#各パラメータの説明)
    - [利用可能なアニメーション](#利用可能なアニメーション)
    - [注意点](#注意点)


# デスティネーション間の遷移をアニメーション化する

## Android View システムの場合

[公式ドキュメント](https://developer.android.com/guide/navigation/use-graph/animate-transitions?hl=ja&_gl=1*1y3sffb*_up*MQ..*_ga*MTU0NjM2NDc1Mi4xNzMzNzkyNDc4*_ga_6HH9YJMN9M*MTczMzk2ODExNi40LjAuMTczMzk2ODExNi4wLjAuNzA3MDg4ODI5#kotlin) に記載されているため、省略します。


## Compose の場合

Compose で、画面遷移時のアニメーションを実装するには、 accompanist ライブラリの AnimatedNavHost を使用することをおすすめします。


### 依存関係の追加

accompanist-navigation-animation ライブラリをプロジェクトに追加します。build.gradle ファイルに以下を追加してください：

```groovy
// groovy
implementation "com.google.accompanist:accompanist-navigation-animation:<latest-version>"
```

最新バージョンは [Accompanist のリリースページ](https://github.com/google/accompanist) を参照してください。


### AnimatedNavHost の使用

AnimatedNavHost を使用して、画面遷移時にカスタムアニメーションを設定します。

```kotlin
import androidx.compose.animation.*
import androidx.navigation.NavHostController
import com.google.accompanist.navigation.animation.AnimatedNavHost
import com.google.accompanist.navigation.animation.composable

@Serializable
object Screen1
@Serializable
object Screen2

@OptIn(ExperimentalAnimationApi::class)
@Composable
fun AppNavHost(navController: NavHostController) {
    AnimatedNavHost(
        navController = navController,
        startDestination = Screen1
    ) {
        composable<Screen1>(
            enterTransition = { _, _ ->
                slideInHorizontally(initialOffsetX = { 1000 }) + fadeIn()
            },
            exitTransition = { _, _ ->
                slideOutHorizontally(targetOffsetX = { -1000 }) + fadeOut()
            },
            popEnterTransition = { _, _ ->
                slideInHorizontally(initialOffsetX = { -1000 }) + fadeIn()
            },
            popExitTransition = { _, _ ->
                slideOutHorizontally(targetOffsetX = { 1000 }) + fadeOut()
            }
        ) {
            Screen1Composable()
        }
        composable<Screen2>(
            enterTransition = { _, _ ->
                slideInVertically(initialOffsetY = { 1000 }) + fadeIn()
            },
            exitTransition = { _, _ ->
                slideOutVertically(targetOffsetY = { -1000 }) + fadeOut()
            }
        ) {
            Screen2Composable()
        }
    }
}
```


### 各パラメータの説明

- enterTransition: 新しい画面が表示されるときのアニメーション。
- exitTransition: 現在の画面が非表示になるときのアニメーション。
- popEnterTransition: popBackStack() で戻ってきたときのアニメーション。
- popExitTransition: popBackStack() で現在の画面が非表示になるときのアニメーション。


### 利用可能なアニメーション

Compose のアニメーション API を活用して、以下のようなアニメーションを組み合わせて使用できます：

- slideInHorizontally / slideOutHorizontally
- slideInVertically / slideOutVertically
- fadeIn / fadeOut
- scaleIn / scaleOut
- カスタムアニメーションも作成可能


### 注意点

- AnimatedNavHost を使用する場合、@OptIn(ExperimentalAnimationApi::class) アノテーションが必要です。
- アニメーションの組み合わせや調整により、ユーザー体験が向上しますが、適切なアニメーション速度や方向を選ぶことが重要です。
