- [NavigationUI を使用して UI コンポーネントを NavController に接続する](#navigationui-を使用して-ui-コンポーネントを-navcontroller-に接続する)
  - [トップアプリバー](#トップアプリバー)
  - [デスティネーションとメニュー項目を結び付ける](#デスティネーションとメニュー項目を結び付ける)
  - [ナビゲーション ドロワーを追加する](#ナビゲーション-ドロワーを追加する)
  - [ボトム ナビゲーション](#ボトム-ナビゲーション)
  - [ナビゲーション イベントをリッスンする](#ナビゲーション-イベントをリッスンする)


# NavigationUI を使用して UI コンポーネントを NavController に接続する

## トップアプリバー


## デスティネーションとメニュー項目を結び付ける

NavigationUI は、デスティネーションをメニュー方式の UI コンポーネントに結び付けるヘルパーも提供します。NavigationUI には [onNavDestinationSelected()](https://developer.android.com/reference/androidx/navigation/ui/NavigationUI?hl=ja&_gl=1*1po7qb4*_up*MQ..*_ga*MTE2NDQ0OTQ1MS4xNzM0MDc4NjI1*_ga_6HH9YJMN9M*MTczNDA3ODYyNS4xLjAuMTczNDA3ODk5Ny4wLjAuMTM0NDYyNDY2OQ..#onnavdestinationselected) ヘルパー メソッドが含まれており、このヘルパー メソッドは、 [MenuItem](https://developer.android.com/reference/android/view/MenuItem?hl=ja&_gl=1*1po7qb4*_up*MQ..*_ga*MTE2NDQ0OTQ1MS4xNzM0MDc4NjI1*_ga_6HH9YJMN9M*MTczNDA3ODYyNS4xLjAuMTczNDA3ODk5Ny4wLjAuMTM0NDYyNDY2OQ..) と、関連付けられたデスティネーションをホストする [NavController](https://developer.android.com/reference/androidx/navigation/NavController?hl=ja&_gl=1*7mlhkj*_up*MQ..*_ga*MTE2NDQ0OTQ1MS4xNzM0MDc4NjI1*_ga_6HH9YJMN9M*MTczNDA3ODYyNS4xLjAuMTczNDA3ODk5Ny4wLjAuMTM0NDYyNDY2OQ..) を受け取ります。MenuItem の id がデスティネーションの id と一致すると、NavController は、そのデスティネーションへのナビゲーションを実行します。

たとえば、以下の XML スニペットの場合、メニュー項目とデスティネーションを定義する際、共通の id である details_page_fragment を使用しています。

```xml
<?xml version="1.0" encoding="utf-8"?>
<navigation xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools"
    xmlns:android="http://schemas.android.com/apk/res/android"
    ... >

    ...

    <fragment android:id="@+id/details_page_fragment"
         android:label="@string/details"
         android:name="com.example.android.myapp.DetailsFragment" />
</navigation>
```

```xml
<menu xmlns:android="http://schemas.android.com/apk/res/android">

    ...

    <item
        android:id="@+id/details_page_fragment"
        android:icon="@drawable/ic_details"
        android:title="@string/details" />
</menu>
```

たとえば、アクティビティの onCreateOptionsMenu() からメニューを追加した場合、メニュー項目をデスティネーションに関連付けるには、アクティビティの onOptionsItemSelected() をオーバーライドして onNavDestinationSelected() を呼び出すようにします。以下の例をご覧ください。

```kotlin
override fun onOptionsItemSelected(item: MenuItem): Boolean {
    val navController = findNavController(R.id.nav_host_fragment)
    return item.onNavDestinationSelected(navController)
        || super.onOptionsItemSelected(item)
}
```

以上の設定により、ユーザーが details_page_fragment メニュー項目をタップすると、同じ id を持つデスティネーションに自動的に移動するようになります。


## ナビゲーション ドロワーを追加する

ナビゲーション ドロワーは、アプリのメイン ナビゲーション メニューを表示する UI パネルです。 ドロワーは、ユーザーがアプリバー内のドロワー アイコンをタップしたときや、画面の左端からスワイプしたときに表示されます。

<img src="./画像/ナビゲーション メニューを表示している開いたドロワー.png" width="300">

ドロワー アイコンは、DrawerLayout を使用しているすべてのトップレベル デスティネーション上で表示されます。

ナビゲーション ドロワーを追加するには、まず、DrawerLayout をルートビューとして宣言します。DrawerLayout 内に、メイン UI コンテンツのレイアウトと、ナビゲーション ドロワーのコンテンツを格納する別のビューを追加します。

たとえば、下記のレイアウトの場合、2 つの子ビューを持つ DrawerLayout を使用しています。一方の子ビューは、メイン コンテンツを格納する NavHostFragment で、もう一方の子ビューは、ナビゲーション ドロワーのコンテンツ用の NavigationView です。

```xml
<?xml version="1.0" encoding="utf-8"?>
<!-- Use DrawerLayout as root container for activity -->
<androidx.drawerlayout.widget.DrawerLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    android:id="@+id/drawer_layout"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:fitsSystemWindows="true">

    <!-- Layout to contain contents of main body of screen (drawer will slide over this) -->
    <androidx.fragment.app.FragmentContainerView
        android:name="androidx.navigation.fragment.NavHostFragment"
        android:id="@+id/nav_host_fragment"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        app:defaultNavHost="true"
        app:navGraph="@navigation/nav_graph" />

    <!-- Container for contents of drawer - use NavigationView to make configuration easier -->
    <com.google.android.material.navigation.NavigationView
        android:id="@+id/nav_view"
        android:layout_width="wrap_content"
        android:layout_height="match_parent"
        android:layout_gravity="start"
        android:fitsSystemWindows="true" />

</androidx.drawerlayout.widget.DrawerLayout>
```

次に、DrawerLayout を AppBarConfiguration に渡して、ナビゲーション グラフに接続します。次の例をご覧ください。

```kotlin
val appBarConfiguration = AppBarConfiguration(navController.graph, drawerLayout)
```

注: NavigationUI を使用している場合、現在のデスティネーションが変更されると、トップ アプリバー ヘルパーが、ドロワー アイコンと「上へ」アイコンとの切り替えを自動的に行います。ActionBarDrawerToggle を使用する必要はありません。

次に、メイン アクティビティ クラス内で、メイン アクティビティの onCreate() メソッドから [setupWithNavController()](https://developer.android.com/reference/androidx/navigation/ui/NavigationUI?hl=ja&_gl=1*1jrtukm*_up*MQ..*_ga*MTE2NDQ0OTQ1MS4xNzM0MDc4NjI1*_ga_6HH9YJMN9M*MTczNDA3ODYyNS4xLjAuMTczNDA3ODk5Ny4wLjAuMTM0NDYyNDY2OQ..#setupWithNavController(com.google.android.material.navigation.NavigationView,%20androidx.navigation.NavController)) を呼び出します。以下をご覧ください。

```kotlin
override fun onCreate(savedInstanceState: Bundle?) {
    setContentView(R.layout.activity_main)

    ...

    val navHostFragment =
        supportFragmentManager.findFragmentById(R.id.nav_host_fragment) as NavHostFragment
    val navController = navHostFragment.navController
    findViewById<NavigationView>(R.id.nav_view)
        .setupWithNavController(navController)
}
```

注: ナビゲーション ドロワーを設定するには、ナビゲーション グラフとメニュー XML も設定する必要があります。詳しくは、デスティネーションとメニュー項目を結び付けるをご覧ください。
Navigation 2.4.0-alpha01 以降では、setupWithNavController を使用すると、各メニュー項目の状態を保存、復元できます。


## ボトム ナビゲーション


## ナビゲーション イベントをリッスンする

















