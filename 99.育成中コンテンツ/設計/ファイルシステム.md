<!-- TOC depthFrom:1 depthTo:6 withLinks:1 updateOnSave:1 orderedList:0 -->

- [ファイルシステム](#ファイルシステム)
	- [メモ帳アプリでファイル管理方法を「ファイル名」ではなく「ID」にした理由](#メモ帳アプリでファイル管理方法をファイル名ではなくidにした理由)
	- [ファイルを一意に特定するのに「ファイル名」を使用するか「ID」を使用するか](#ファイルを一意に特定するのにファイル名を使用するかidを使用するか)
	- [ファイルには必ず拡張子をつけること](#ファイルには必ず拡張子をつけること)

<!-- /TOC -->


# ファイルシステム

## メモ帳アプリでファイル管理方法を「ファイル名」ではなく「ID」にした理由

メモ帳アプリで、最初は、メモのタイトルをファイル名としてデバイスにファイル保存していた。

このメモ帳アプリは、メモを開くと、タイトルと内容の入力欄が別々に存在している。保存ボタンは一つだけ存在しており、そのボタンでタイトルだけを変更することもできるし、内容のみも変更できるし、もちろん両方同時に変更することもできるようにした。

このUIにすると、いくつかややこしい管理が必要になる。

例えば、タイトルを変更していない場合に、保存ボタンを押した場合は、ファイルの上書き保存をしたいと考えるだろう。
また、タイトルを変更した場合に、保存ボタンを押した場合には、既存ファイルに同一ファイル名のファイルが存在していたらエラーにしたいと考えるだろう。
これらのケースは、前者は、同一ファイル名のファイルが存在していてもOKなケース。後者は、同一ファイル名のファイルが存在していてはNGなケースである。
これらを判定するために、タイトルに変更があったかどうかを判定しなければいけない。


## ファイルを一意に特定するのに「ファイル名」を使用するか「ID」を使用するか

Windowsのようなファイルシステムでは、
「ファイルを開いている時にファイル名を更新できない」

もし、開いている時にファイル名を更新できたとすると、
以下の手順で操作した場合に、
1. ファイルを開く
2. ファイル名を更新する
3. 1で開いたファイルの中身を書き換える
4. 3のファイルを保存する

4の保存時に、ファイル名更新後の新しいファイルを開き直し、そのファイルへ更新後の中身を書き込む必要がある。
それは、できなくはないと思うが、色々ややこしくなる。
例えば、同一ファイル名のファイルがすでに存在している時は、上書きさせたくないので、書き込みエラーにする必要がある。
しかし、ファイル名に変更がなくて同一ファイル名で保存しようとしているのかもしれない。
同一ファイル名の別ファイルが存在しているのか、それとも、ファイル名に変更がなくて同一ファイル名で保存しようとしているのかの区別ができない。

そのややこしさを回避するために、ファイルオープン時のファイル名変更をできないようにしている。

もし、ファイルオープン時のファイル名変更を行えるようにしたいのならば、
「ファイルを一意に特定するためのファイルIDを設ける」
「ファイルを一意に特定するのにファイル名は使用しない」
とする必要がある。


## ファイルには必ず拡張子をつけること

ファイルに拡張子がついていないとOSやJavaにディレクトリだと認識されてしまうようで、ファイル名とディレクトリ名が同じアイテムが共存できない。
そのため、これに起因する予期せぬトラブルを防ぐためにファイルを作成する際には、必ず拡張子をつけること。

