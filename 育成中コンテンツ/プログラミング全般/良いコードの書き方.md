- [良いコードの書き方](#良いコードの書き方)
  - [フィールドはなるべく定義しない](#フィールドはなるべく定義しない)
  - [コードの修正時に、できる限り既存コードの修正が不要な設計にする](#コードの修正時にできる限り既存コードの修正が不要な設計にする)
  - [あまり多くのメソッドやクラスに依存されない設計にする](#あまり多くのメソッドやクラスに依存されない設計にする)
  - [低結合・高凝縮](#低結合高凝縮)


# 良いコードの書き方

## フィールドはなるべく定義しない

フィールドは様々なところから更新される可能性があるため、  
予期せぬ動作が発生する原因につながります。

フィールドを参照している処理に手を加える場合、  
そのフィールドが更新されているところを全て調べないと、  
「そのフィールドがどのタイミングでどんな値になっているのか」  
がわからないため、影響調査に時間がかかりやすくなる。


## コードの修正時に、できる限り既存コードの修正が不要な設計にする

コードの修正時に、できる限り既存コードの修正が不要な設計にすることで、コードの修正が怖くなくなります。

特に、機能を追加する場合には、既存コードを一切修正不要になっていることが望ましいです。新機能の追加の場合は、理論上、それができるはずです。

既存機能を変更する場合には、既存コードが修正されることは、ある程度は仕方がないことです。しかし、修正はできる限り少なくなるべきです。たくさんの修正は、不具合につながやすくなります。


## あまり多くのメソッドやクラスに依存されない設計にする

コードは、なるべく少ない呼び出し元からの呼び出しになるように設計するべきです。

コードを修正するということは、それが、他のクラスやメソッドに、影響があろうがなかろうが、「影響があるかもしれない」という恐怖が伴います。その恐怖を乗り越えるためには、そのメソッドやクラスの使用箇所をすべて調べる必要があります。その際に、メソッドの呼び出し元や、クラスの依存元が少なければ、調べることが簡単になります。

**「コードを修正することが怖い」** と感じること自体がリスクです。怖いと感じない設計をするべきです。

その方法の一つとして、いろいろな基本概念や、デザインパターンなどがあります。

例えば、メソッドの場合は、「副作用がない／ドメインに依存しない純粋な関数」ならば、多くの呼び出し元から呼び出しても問題ありません。ドメインとは、一言でいうと、アプリ固有の特定の業務におけるビジネスロジックです。どんなアプリでも使えるロジックなら、それは、ドメインに依存しない純粋な関数であると言えます。


## 低結合・高凝縮

- 低結合
  - 依存はなるべく減らす
  - 依存が少ないと再利用しやすい
- 高凝縮
  - 近いもの同士なら、互いに依存しあっても問題ない。
  - 依存する範囲が限定的で、影響範囲が限定的だから。

