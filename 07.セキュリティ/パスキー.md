- [パスキー](#パスキー)
  - [パスキーの仕組み](#パスキーの仕組み)
    - [公開鍵と秘密鍵のペアの生成](#公開鍵と秘密鍵のペアの生成)
    - [サーバーへの公開鍵の登録](#サーバーへの公開鍵の登録)
    - [ログイン時の認証](#ログイン時の認証)
    - [認証の成功](#認証の成功)
  - [セキュリティの利点](#セキュリティの利点)
  - [生体認証との統合](#生体認証との統合)
  - [引用元資料](#引用元資料)


# パスキー

パスキーとは、公開鍵暗号方式を使用した認証方式です。


## パスキーの仕組み

### 公開鍵と秘密鍵のペアの生成

パスキーは、公開鍵と秘密鍵という 2 つの鍵を使用します。

- **公開鍵**
  - サーバー側に保存され、認証の際に使われます。公開鍵は誰でもアクセスできます。
- **秘密鍵**
  - ユーザーのデバイスに保存され、絶対に他人に知られません。秘密鍵は認証のために使われます。

ユーザーがサービスにサインアップ (アカウント登録) すると、まず、ユーザーの端末で、公開鍵と秘密鍵のペアを生成します。このペアを使って、後の認証プロセスが行われます。


### サーバーへの公開鍵の登録

サーバーには、ユーザーの **公開鍵** が送信され、保存されます。秘密鍵は、ユーザーのデバイスにのみ保存されるため、サーバーがハッキングされても、秘密鍵が漏れることはありません。


### ログイン時の認証

ユーザーがサービスにログインしようとすると、サーバーは、ユーザーに対して「チャレンジ」と呼ばれるランダムなデータを送信します。この時、後で認証するために、ユーザー ID もチャレンジと一緒に保持しておきます。

- ユーザーのデバイスは、チャレンジを受け取ると、保存されている **秘密鍵** で、そのチャレンジに署名します。
- 署名されたデータはサーバーに送信され、サーバーは保存している **公開鍵** を使って、その署名が正当なものであるかを確認します。


### 認証の成功

もし、署名が公開鍵で正しく検証できれば、サーバーは、ユーザーが正当な人物であると認証します。これによって、パスワードを一切使わずにログインすることができます。


## セキュリティの利点

- パスワードレス
  - ユーザーはパスワードを覚える必要がなく、盗まれるリスクも減ります。
- フィッシング攻撃に強い
  - パスワードを盗む方法がなく、フィッシング攻撃にも強くなります。
- 端末間の認証
  - パスキーは、基本的には、デバイスに保存されていますが、クラウドで同期することで、異なる端末でも使用可能になります。
  - また、新しいスマートフォンに機種変更する際に、古いスマートフォンで QR コードを表示し、新しいスマートフォンで、その QR コードを読み取ると、秘密鍵を新しいスマートフォンに移行することができるようです。この際、 QR コードは、秘密鍵そのものを表現するのではなく、秘密鍵を復元する情報を共有しているらしい。


## 生体認証との統合

多くの場合、パスキーは生体認証（指紋認証や顔認証など）と連携して使用されます。具体的には、パスキーの秘密鍵を使用する際には、その権限があることを確かめるために、生体認証に成功した場合にのみ、秘密鍵を使用可能にします。

ユーザーが、自分のデバイスで、指紋や顔を認証することで、セキュリティがさらに強化されます。


## 引用元資料

- ChatGPT との対話

