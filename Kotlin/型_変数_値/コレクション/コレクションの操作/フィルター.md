- [フィルター](#フィルター)
  - [概要](#概要)
  - [フィルター元への影響はない](#フィルター元への影響はない)
  - [基本形](#基本形)
  - [抽出条件にインデックスを使用する](#抽出条件にインデックスを使用する)
  - [使いどころ](#使いどころ)
  - [条件が false の場合に抽出する](#条件が-false-の場合に抽出する)
  - [特定の型に一致する要素のみを抽出する](#特定の型に一致する要素のみを抽出する)
  - [null 以外の要素を抽出する](#null-以外の要素を抽出する)
  - [二つのリストに分割する](#二つのリストに分割する)
  - [コレクション内の全ての要素の中に条件に一致する要素が一つでも存在するかどうかの判定](#コレクション内の全ての要素の中に条件に一致する要素が一つでも存在するかどうかの判定)
  - [コレクション内の全ての要素の中に条件に一致する要素が一つも存在しないかどうかの判定](#コレクション内の全ての要素の中に条件に一致する要素が一つも存在しないかどうかの判定)
  - [コレクション内の全ての要素が条件に一致するかどうかの判定](#コレクション内の全ての要素が条件に一致するかどうかの判定)


# フィルター

## 概要

フィルターは、フィルター条件が true を返せば、その要素は抽出され、 false を返せば除外されます。

フィルターした結果は、プロパティに代入するか、関数チェーンして使用することができます。


## フィルター元への影響はない

Kotlin の標準ライブラリのフィルター関数は、拡張関数です。これらの関数は、フィルター元のコレクションに変更を加えません。そのため、 読み取り専用コレクションでも書き込み可能なコレクションでも使用可能です。


## 基本形

フィルターの基本形は、 `filter()` 関数を使用したフィルタリングです。条件式の処理結果で true を返す要素が抽出されます。

フィルター元のオブジェクトが List か Set の場合は、フィルター後は List 型のオブジェクトを返します。フィルター元のオブジェクトが Map の場合には、 Map 型のオブジェクトを返します。

```kotlin
val numbers = listOf("one", "two", "three", "four")  
val longerThan3 = numbers.filter { it.length > 3 }
println(longerThan3)
// [three, four]

val numbersMap = mapOf("key1" to 1, "key2" to 2, "key3" to 3, "key11" to 11)
val filteredMap = numbersMap.filter { (key, value) -> key.endsWith("1") && value > 10}
println(filteredMap)
// {key11=11}
```


## 抽出条件にインデックスを使用する

`filter()` 関数は、フィルターの条件作成時に、要素の値しか使用することができません。もし、要素のインデックスも使用したい場合には `filterIndexed()` 関数を使用します。この関数は `Iterable` インターフェースの拡張関数として定義されているため、 List と Set で使用することが可能です。

```kotlin
val numbers = listOf("one", "two", "three", "four")
val filteredIdx = numbers.filterIndexed { index, s -> (index != 0) && (s.length < 5)  }
println(filteredIdx)
// [two, four]

val s = setOf(1, 2, 3, 4, 5)
val filteredSet = s.filterIndexed { index, i -> i % 2 == 0 }
println(filteredSet)
// [2, 4]
```


## 使いどころ

filter() 関数や filterIndexed() 関数は、新しい List や Map を生成して返すため、 Immutable なコレクションから、特定の要素を除外した新しいコレクションを生成したい場合に使用すると便利です。


## 条件が false の場合に抽出する

```kotlin
val numbers = listOf("one", "two", "three", "four")

val filteredNot = numbers.filterNot { it.length <= 3 }

println(filteredNot)
// [three, four]
```


## 特定の型に一致する要素のみを抽出する

```kotlin
val numbers = listOf(null, 1, "two", 3.0, "four")
println("All String elements in upper case:")
numbers.filterIsInstance<String>().forEach {
    println(it.uppercase())
}
// 実行結果
// TWO
// FOUR
```


## null 以外の要素を抽出する

```kotlin
val numbers = listOf(null, "one", "two", null)
numbers.filterNotNull().forEach {
    println(it.length)
}
// 実行結果
// 3
// 3
```


## 二つのリストに分割する

`partition()` 関数を使用すると、抽出条件に一致した要素のみを含むコレクションと一致しなかった要素のみを含むコレクションを `Pair<List, List>` で返します。この関数は Iterable インターフェースの拡張関数となっているため、 List と Set で使用することができます。

`Pair<List, List>` の一つ目の List が抽出条件に一致したリスト、二つ目のリストが一致しなかったリストになります。

```kotlin
// List の使用例
val numbers = listOf("one", "two", "three", "four")
val (match, rest) = numbers.partition { it.length > 3 }
println(match) // [three, four]
println(rest) // [one, two]

// Set の使用例
val s = setOf(1, 2, 3)
val (matched, notMatched) = s.partition { i -> i % 2 == 0 }
println(matched) // [2]
println(notMatched) // [1, 3]
```


## コレクション内の全ての要素の中に条件に一致する要素が一つでも存在するかどうかの判定

`any()` 関数は、コレクション内の全ての要素の中に条件に一致する要素が一つでも存在する場合は true を返します。それ以外の場合は false を返します。

```kotlin
val numbers = listOf("one", "two", "three", "four")

println(numbers.any { it.endsWith("e") }) // true
```

`any()` 関数の引数が指定されていない場合は、全ての要素が条件を満たしたと見なします。そのため、 any() 関数はコレクション内に要素が一つでも存在していれば、 true を返し、空なら false を返します。

```kotlin
val numbers = listOf("one", "two", "three", "four")
val empty = emptyList<String>()

println(numbers.any(/* 条件なし */)) // true
println(empty.any(/* 条件なし */)) // false
```


## コレクション内の全ての要素の中に条件に一致する要素が一つも存在しないかどうかの判定

`none()` 関数は、コレクション内の全ての要素の中に条件に一致する要素が一つも存在しない場合は、 true を返します。それ以外の場合は false を返します。

```kotlin
val numbers = listOf("one", "two", "three", "four")

println(numbers.none { it.endsWith("a") }) // true
```

`none()` 関数の引数が指定されていない場合は、全ての要素が条件を満たしたと見なします。そのため、 none() 関数はコレクション内に要素が一つでも存在していれば false を返し、空なら true を返します。

```kotlin
val numbers = listOf("one", "two", "three", "four")
val empty = emptyList<String>()

println(numbers.none(/* 条件なし */)) // false
println(empty.none(/* 条件なし */)) // true
```


## コレクション内の全ての要素が条件に一致するかどうかの判定

`all()` 関数は、 コレクション内の全ての要素が条件に一致する（ラムダ式内で true が返される）場合は true を返します。それ以外の場合は false を返します。

コレクションが空の場合は、条件が何であろうと true を返します。これは数学用語で 「空虚な真 ( vacuous truth ) 」 と呼ばれます。

```kotlin
val numbers = listOf("one", "two", "three", "four")

println(numbers.all { it.endsWith("e") }) // false

println(emptyList<Int>().all { it > 5 })   // true
```






