- [エスケープ処理](#エスケープ処理)
  - [エスケープ処理が行われるタイミング](#エスケープ処理が行われるタイミング)
    - [1. 文字列リテラルの定義時](#1-文字列リテラルの定義時)
    - [2. 正規表現のパターンのコンパイル時](#2-正規表現のパターンのコンパイル時)
  - [Illegal escape エラー](#illegal-escape-エラー)
  - [エスケープ処理が必要かどうかの判断方法](#エスケープ処理が必要かどうかの判断方法)


# エスケープ処理

## エスケープ処理が行われるタイミング

エスケープ処理は、以下の二つのタイミングで実行されます。

1. 文字列リテラルの定義時
2. 正規表現のパターンのコンパイル時

### 1. 文字列リテラルの定義時

以下の例では、エスケープ処理が行われた後に文字列が変数 s に格納されます。

```kotlin
val s = "\\" // <--- この段階でエスケープ処理が実施されます。
println("s = $s") // s = \
```


### 2. 正規表現のパターンのコンパイル時

```kotlin
// バックスラッシュ一文字 ( '\' ) を示す。
val target = "\\"

// 以下の二箇所でエスケープ処理が実施されます。
// 1. 文字列リテラルの定義時
// 2. Regex クラスのコンストラクタ内でパターンをコンパイルする時
val regex = Regex("\\\\")

val isMatched = regex.matches(target)
println("$isMatched") // true
```

上記の `Regex("\\\\")` では、エスケープ処理が二回実施されます。一回目のエスケープ処理で `"\\\\"` が `"\\"` になり、二回目のエスケープ処理で `"\\"` が `"\"` になります。


## Illegal escape エラー

エスケープできない文字をエスケープしようとした際などには、コンパイル時に `Illegal escape` エラーが発生します。

```kotlin
val s = "\a"
```


## エスケープ処理が必要かどうかの判断方法

その文字が特殊文字だと見なされる場合にはエスケープ処理が必要です。

例えば、 `"+"` という文字は、正規表現のパターンとして渡される場合には特殊文字と見なされ、そうでない場合には、単なる文字と見なされます。  
場合によっては、正規表現のパターンとして渡しても、単なる文字として認識させたい場合もあるでしょう。そういった場合には、エスケープ処理が必要となります。


