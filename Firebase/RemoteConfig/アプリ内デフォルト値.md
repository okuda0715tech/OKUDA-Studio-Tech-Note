<!-- TOC START min:1 max:3 link:true asterisk:false update:true -->
- [アプリ内デフォルト値](#アプリ内デフォルト値)
  - [アプリ内デフォルト値の効果](#アプリ内デフォルト値の効果)
  - [アプリ内デフォルト値の設定方法](#アプリ内デフォルト値の設定方法)
  - [xml ファイルから取り込む方法](#xml-ファイルから取り込む方法)
    - [xml ファイルを作成する](#xml-ファイルを作成する)
    - [xml ファイルの例](#xml-ファイルの例)
    - [xml ファイルを Remote Config オブジェクトに取り込む](#xml-ファイルを-remote-config-オブジェクトに取り込む)
  - [Map から取り込む方法](#map-から取り込む方法)
<!-- TOC END -->


# アプリ内デフォルト値

## アプリ内デフォルト値の効果

アプリは常にインターネットに接続しているとは限らないため、アプリ内デフォルト値を設定することは必須です。  
もしも、アプリ内デフォルト値を設定していない場合は、パラメータ取得の get メソッドを実行した時に、  
プリミティブ型の初期値が返されます。具体的には次の通りです。

```
getString() -> ""
getLong() -> 0L
getDouble() -> 0D
getBoolean() -> false
```

アプリ内デフォルト値は、以下の 3 つの各状況下で get メソッドが実行された場合に使用されます。

1. サーバー側の 「アプリ内デフォルト値を使用する」 が ON になっている場合
2. フェッチされた値が有効化されていない場合
3. サーバーに該当の名前のパラメータが存在しない場合


## アプリ内デフォルト値の設定方法

アプリ内デフォルト値は、 「 xml ファイルに定義された値を取り込む方法」 と、  
「 `Map` に定義された値を取り込む方法」 があります。


## xml ファイルから取り込む方法

デフォルト値を定義した xml ファイルを用意し、それを Remote Config オブジェクトに  
取り込むことでデフォルト値が設定されます。


### xml ファイルを作成する

Firebase コンソールを使用して、 Firebase Remote Config サーバー側に設定されているデフォルト値を  
xml 形式で出力することが可能です。

出力される xml は、あくまでアプリ内デフォルト値を設定するファイルであるため、  
サーバー側で設定した条件や、その条件値は含まれていません。


### xml ファイルの例

```xml
<?xml version="1.0" encoding="utf-8"?>
<defaultsMap>
    <entry>
        <key>loading_phrase</key>
        <value>Fetching config…</value>
    </entry>
    <entry>
        <key>welcome_message_caps</key>
        <value>false</value>
    </entry>
    <entry>
        <key>welcome_message</key>
        <value>Welcome to my awesome app!</value>
    </entry>
</defaultsMap>
```


### xml ファイルを Remote Config オブジェクトに取り込む

アプリ内デフォルト値を定義した、 xml ファイルは、 `res/xml` フォルダに格納します。  
その後、アプリで以下のコードを実行することにより、アプリ内の Remote Config オブジェクトに取り込まれます。

```java
mFirebaseRemoteConfig = FirebaseRemoteConfig.getInstance();
mFirebaseRemoteConfig.setDefaultsAsync(R.xml.remote_config_defaults);
```


## Map から取り込む方法

以下のように実装することで、 Map オブジェクトを Remote Config オブジェクトに取り込むことができます。

```java
Map<String, Object> defaults;

// ここで defaults を初期化します。
// Map のキーに Remote Config のキーを設定し、
// Map のバリューに Remote Config のバリューを設定します。

mFirebaseRemoteConfig = FirebaseRemoteConfig.getInstance();
mFirebaseRemoteConfig.setDefaultsAsync(defaults);
```
