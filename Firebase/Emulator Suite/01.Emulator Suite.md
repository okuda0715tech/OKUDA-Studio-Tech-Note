- [Emulator Suite](#emulator-suite)
  - [🔧 使えるエミュレータの例](#-使えるエミュレータの例)
  - [✅ Firebase Emulator Suite を使うメリット](#-firebase-emulator-suite-を使うメリット)
  - [🚀 簡単な使い方の流れ（Firestore を例に）](#-簡単な使い方の流れfirestore-を例に)
    - [1. Firebase CLI をインストール](#1-firebase-cli-をインストール)
    - [2. プロジェクト初期化](#2-プロジェクト初期化)
    - [3. エミュレータを起動](#3-エミュレータを起動)
    - [4. アプリ側でエミュレータに接続](#4-アプリ側でエミュレータに接続)
      - [useEmulator() 関数の引数](#useemulator-関数の引数)
  - [💡注意点](#注意点)
  - [ローカル PC での作業](#ローカル-pc-での作業)
  - [引用元資料](#引用元資料)


# Emulator Suite

Firebase Emulator Suite は、Firebase の各種サービス（Firestore、Realtime Database、Authentication、Cloud Functions など）を ローカル環境 (アプリを開発中の PC ) で安全にテスト・開発できるツール群 です。サーバーにアクセスせずに、アプリやバックエンドの挙動を確認・デバッグできるのが大きな特徴です。

これは、Firebase サービスの模擬サーバーをローカルで動かしていると考えると分かりやすいです。


## 🔧 使えるエミュレータの例

以下の Firebase サービスに対応したエミュレータがあります：

- Authentication Emulator
  - ログイン/ログアウトの挙動をローカルでテストできる。
- Firestore Emulator
  - Firestore データベースをローカルで操作可能。
- Realtime Database Emulator
- Cloud Functions Emulator
  - HTTPS やバックグラウンド関数をローカルでテストできる。
- Cloud Storage Emulator
  - ファイルのアップロード・ダウンロードをローカルで確認できる。
- Pub/Sub Emulator
  - Cloud Pub/Sub のローカルテスト。
- Firebase Hosting Emulator
  - Firebase Hosting での配信をローカルで確認可能。


## ✅ Firebase Emulator Suite を使うメリット

- 課金リスクなし
  - クラウドを使わないので、料金が発生しない。
- 高速な開発サイクル
  - クラウドにデプロイせずに即時確認できる。
- オフライン開発が可能
  - ネット接続不要でテストできる。
- CI との連携
  - 自動テストにも組み込みやすい。


## 🚀 簡単な使い方の流れ（Firestore を例に）

### 1. Firebase CLI をインストール

```bash
npm install -g firebase-tools
```

Emulator Suite は、ローカルで実行するサービス (ツール) であるため、 Firebase Console は使用しません。


### 2. プロジェクト初期化

```bash
firebase init
```

Firestore、Functions、Emulators など必要なものを選択。


### 3. エミュレータを起動

```bash
firebase emulators:start
```


### 4. アプリ側でエミュレータに接続

Kotlin（Android）の場合：

```kotlin
FirebaseFirestore.getInstance().useEmulator("10.0.2.2", 8080)
```

10.0.2.2 は Android エミュレータから見たホスト PC の IP です。


#### useEmulator() 関数の引数

useEmulator() 関数の引数には、ホストとポートを指定します。

- ホスト
  - Firebase Emulator が動いているマシンの IP アドレス、または、ホスト名
    - 同 PC 上で、 Android エミュレーターを使用している場合は、 `"10.0.2.2"` とします。
    - Android の実機を使用している場合は、 `"192.168.0.5"` など、 PC のローカル IP を指定します。
- ポート
  - そのエミュレータが使っているポート番号（設定で変更可能）
    - デフォルトのポート番号は、どのサービスを使用するかによって決まっています。例えば：
      - Firestore: 8080
      - Authentication: 9099
      - Functions: 5001
    - ただし、これらのポートは firebase.json や CLI の引数で変更できます。


## 💡注意点

- 本番環境と挙動が完全に同じとは限らない。
- useEmulator() を入れ忘れると本番にアクセスしてしまう。
- Firestore のセキュリティルールもローカルで検証可能。


## ローカル PC での作業

- ローカル PC 上では、 Emulator UI（ローカルのダッシュボード）が使用できます。
- firebase emulators:start を実行した後に表示される URL（例: http://localhost:4000）にアクセスすると、 Emulator UI が表示されます。
- Emulator UI では、 Firestore のドキュメント閲覧・編集、Auth ユーザーの追加などができます。
- ターミナル上に、Firestore 書き込みや関数のログなどが出るので、デバッグに役立ちます。


## 引用元資料

- ChatGPT


