- [Realtime Database](#realtime-database)
  - [🔹 Realtime Database とは？](#-realtime-database-とは)
  - [🔸 主な特徴](#-主な特徴)
  - [🔹 データ構造のイメージ（JSON）](#-データ構造のイメージjson)
  - [🔸 基本操作（Kotlin / Android）](#-基本操作kotlin--android)
    - [🔸 データの書き込み](#-データの書き込み)
    - [🔸 データの読み込み（ 1 回だけ）](#-データの読み込み-1-回だけ)
    - [🔸 リアルタイムで監視](#-リアルタイムで監視)
  - [🔹 Realtime Database を使うべきケース](#-realtime-database-を使うべきケース)
  - [🔸 Firestore との違い（ざっくり）](#-firestore-との違いざっくり)
  - [引用元資料](#引用元資料)


# Realtime Database

Realtime Database は、 2012 年に公開されたサービスで、スケーラビリティやセキュリティ管理などの面で、課題がありました。その使いにくさを改善したものが Firestore で、こちらは、 2019 年に正式版がリリースされています。基本的には、 Firestore の方が優れているため、特にこだわりがなければ、 Firestore を使用した方が良いです。


## 🔹 Realtime Database とは？

- Firebase のクラウド型 NoSQL データベース
- データは JSON 形式 で保存される
- 変更があると、リアルタイムでクライアントに通知される（push 型）
- Android/iOS/Web で同じように使える


## 🔸 主な特徴

- リアルタイム同期：複数端末でデータが瞬時に同期される
- オフライン対応：ローカルにキャッシュがあり、オフライン時でも動作
- セキュリティルール：ユーザーごとに読み書きの制御が可能
- 低遅延：少量データであればかなり高速


## 🔹 データ構造のイメージ（JSON）

```json
{
    "users": {
        "user_123": {
            "name": "Taro",
            "age": 25
        },
        "user_456": {
            "name": "Hanako",
            "age": 30
        }
    }
}
```


## 🔸 基本操作（Kotlin / Android）

### 🔸 データの書き込み

```kotlin
val db = FirebaseDatabase.getInstance()
val ref = db.getReference("users").child("user_123")

ref.setValue(User("Taro", 25))
```


### 🔸 データの読み込み（ 1 回だけ）

ユーザーがアプリを起動した際に、データを 1 回だけ読み込むシナリオで使います。

```kotlinref.addListenerForSingleValueEvent(object : ValueEventListener {
    override fun onDataChange(snapshot: DataSnapshot) {
        val user = snapshot.getValue(User::class.java)
        Log.d("TAG", "User name: ${user?.name}")
    }

    override fun onCancelled(error: DatabaseError) {
        Log.w("TAG", "loadPost:onCancelled", error.toException())
    }
})
```


### 🔸 リアルタイムで監視

```kotlin
ref.addValueEventListener(object : ValueEventListener {
    override fun onDataChange(snapshot: DataSnapshot) {
        val user = snapshot.getValue(User::class.java)
    }

    override fun onCancelled(error: DatabaseError) {}
})
```


## 🔹 Realtime Database を使うべきケース

- チャットアプリやリアルタイムで状態を共有したいアプリ
- 複雑なクエリよりも「すぐに更新されること」が重要な場面


## 🔸 Firestore との違い（ざっくり）

- RTDB → ツリー構造、超高速、構造が複雑になりやすい
- Firestore → コレクション＋ドキュメント型、クエリが強い、構造化しやすい



## 引用元資料

- ChatGPT

