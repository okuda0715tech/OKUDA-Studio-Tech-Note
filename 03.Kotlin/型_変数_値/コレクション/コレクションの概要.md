- [コレクションの概要](#コレクションの概要)
  - [読み取り専用のコレクション](#読み取り専用のコレクション)
  - [書き換え可能なコレクション](#書き換え可能なコレクション)
  - [Collection 関連のクラス図](#collection-関連のクラス図)
    - [Collection クラス](#collection-クラス)
    - [MutableCollection クラス](#mutablecollection-クラス)


# コレクションの概要

## 読み取り専用のコレクション

読み取り専用のコレクションは、 **共変** です。例えば、 `Rectanble` クラスが `Shape` クラスを継承しているとすれば、 `List<Rectangle>` クラスも `List<Shape>` クラスを継承しています。

ただし、 Map については、値は **共変** ですが、キーは共変ではありません。


## 書き換え可能なコレクション

書き換え可能なコレクションは、 **共変ではありません** 。もし、 `MutableList<Rectangle>` が `MutableList<Shape>` だった場合は、 `MutableList<Rectangle>` の要素に `Circle` が追加できてしまい、 `MutalbeList<Rectangle>` が汚染されてしまいます。


## Collection 関連のクラス図

<img src="./画像/コレクション関連のクラス図.png" width="500">

それぞれのクラスの役割について、以下で説明していきます。


### Collection クラス

Collection クラスは、読み取り専用のコレクションを扱うことができるクラスです。コレクションのサイズを取得したり、要素を取得することが可能です。 `Iterable<T>` インターフェースを実装しているため、 `for` ループなども可能です。

```kotlin
fun printAll(strings: Collection<String>) {
    for(s in strings) print("$s ")
    println()
}
    
fun main() {
    val stringList = listOf("one", "two", "one")
    printAll(stringList) // one two one
    
    val stringSet = setOf("one", "two", "three")
    printAll(stringSet) // one two three 
}
```


### MutableCollection クラス

MutableCollection クラスは、要素の更新や削除が可能なコレクションです。

```kotlin
fun List<String>.getShortWordsTo(shortWords: MutableList<String>, maxLength: Int) {
    // レシーバーインスタンスから文字数が 3 文字以下のものだけを抽出し、 shortWords に格納する。
    // MutalbleList なので要素の追加が可能
    this.filterTo(shortWords) { it.length <= maxLength }
    val articles = setOf("a", "A", "an", "An", "the", "The")
    // リストから冠詞を除外する。
    // マイナスはリスト内で最初に現れた要素を除外する
    // MutalbleList なので要素の除外が可能
    shortWords -= articles
}

fun main() {
    // 単語を格納した List<String> を生成する
    val words = "A long time ago in a galaxy far far away".split(" ")
    val shortWords = mutableListOf<String>()
    words.getShortWordsTo(shortWords, 3)
    println(shortWords)
}
```




