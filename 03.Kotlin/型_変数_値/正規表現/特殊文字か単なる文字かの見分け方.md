- [特殊文字か単なる文字かの見分け方](#特殊文字か単なる文字かの見分け方)
  - [見分け方のルール](#見分け方のルール)
  - [見分け方の例](#見分け方の例)
  - [ケース１～３で特殊文字と見なされる文字](#ケース１３で特殊文字と見なされる文字)
    - [ケース１で特殊文字と見なされる文字](#ケース１で特殊文字と見なされる文字)
    - [ケース２で特殊文字と見なされる文字](#ケース２で特殊文字と見なされる文字)
    - [ケース３で特殊文字と見なされる文字](#ケース３で特殊文字と見なされる文字)


# 特殊文字か単なる文字かの見分け方

## 見分け方のルール

同じ文字でも特殊文字になる場合とならない場合があります。以下のケース 1 からケース 3 のどのケースなのかによって、ある文字が特殊文字と見なされるのか見なされないのかが決まります。

- 正規表現と見なされない文字列 ---> 【ケース 1 】
  - 特殊文字
  - 通常の文字
- 正規表現と見なされる文字列
  - 大カッコの中 ---> 【ケース 2 】
    - 特殊文字
    - 通常の文字
  - 大カッコの外 ---> 【ケース 3 】
    - 特殊文字
    - 通常の文字

「ケース 1 」 か 「ケース 1 以外」 かの見分け方は、文字列が後続処理で `Pattern.compile()` などの正規表現を扱う関数に渡されているかどうかです。正規表現を扱う関数に渡されていれば、コンパイラーは正規表現の文字列であると見なします。


## 見分け方の例

例えば、 `+` という文字は、ケース 1 とケース 2 の場合は、通常の文字と見なされ、ケース 3 の場合は、特殊文字と見なされます。

```kotlin
// これは単なる文字の '+' です。
val s = "+"

private fun isBackSlash(s: CharSequence): Boolean {
    // この '+' は、 'a' が 1 回以上という意味の特殊文字です。
    val regex = "a+"
    // この '+' は '+' が 1 回という意味の単なる文字です。
    val regex = "[+]{1}"

    val p: Pattern = Pattern.compile(regex)
    val m: Matcher = p.matcher(s)
    return m.matches()
}
```


## ケース１～３で特殊文字と見なされる文字

ケース 1 ～ 3 で特殊文字と見なされる文字をリストアップしておきます。久しぶりに正規表現を読む場合などに以下を参照すると、素早くコードを読む助けになると思います。


### ケース１で特殊文字と見なされる文字

単なる文字列型で特殊文字と見なされる文字は以下になります。

| 文字 | 文字の読み方           | 役割               |
| ---- | ---------------------- | ------------------ |
| `\`  | バックスラッシュ       | エスケープ文字     |
| `"`  | ダブルクォーテーション | 文字列の始点と終点 |
| `\t` | -                      | タブ区切り         |
| `\n` | -                      | 改行               |

上記以外にもあるかもしれませんが、主なところではこのくらいだと思います。


### ケース２で特殊文字と見なされる文字

| 文字 | 文字の読み方      | 例           | 例の意味                                                     |
| ---- | ----------------- | ------------ | ------------------------------------------------------------ |
| `-`  | ハイフン          | `a-z`        | a から z までという範囲 (境界を含む)                         |
| `^`  | チルダ            | `^abc`       | a でも b でも c でもない文字                                 |
| `[]` | 大カッコ          | -            | (論理和や論理積を算出する際の文字クラスのかたまりを形成する) |
| `&&` | アンパサント 2 個 | [a-z&&[^bc]] | a から z の中から b と c を除いた残り (論理積)               |
|      |                   |              |                                                              |

その他には、後述する 「定義済みの文字クラス」 というものがあります。例えば、 「 `\d` は、 `[0-9]` と同義」など。また、単なる文字列内で特殊文字とみなされる文字は、ここでも特殊文字とみなされます。


### ケース３で特殊文字と見なされる文字

数量子 / 論理演算子は特殊文字とみなされ、それ以外は単なる文字とみなされる？



