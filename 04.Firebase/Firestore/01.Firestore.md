- [Firestore](#firestore)
  - [概要](#概要)
  - [特徴](#特徴)
  - [よくある用途](#よくある用途)
  - [料金について](#料金について)
  - [NoSQL データベースの特徴](#nosql-データベースの特徴)
  - [Firestore の用途](#firestore-の用途)
    - [ユーザー固有のデータの保存](#ユーザー固有のデータの保存)
      - [注意点](#注意点)
    - [全ユーザー共通のデータの保存](#全ユーザー共通のデータの保存)
  - [Firestore のデータ構造](#firestore-のデータ構造)
  - [引用元資料](#引用元資料)


# Firestore

## 概要

Firestore ( Cloud Firestore / Firestore Database とも呼ばれる) は、 Google が提供する NoSQL 型のクラウドデータベースです。リアルタイム同期機能やオフラインサポートがあり、モバイルやウェブアプリのバックエンドによく使われます。


## 特徴

- NoSQL データベース
  - JSON ライクなデータをネストすることで、ドキュメントの階層構造を実現しています。
  - JSON ライクなデータの階層構造は、データベースのようなデータ構造を実現します。
  - 詳細は、 [Firestore のデータ構造](#firestore-のデータ構造) セクションを参照してください。
- リアルタイム同期
  - クライアントがデータの変更を即座に受け取れる。
- スケーラブル
  -  少人数のアプリから大規模なサービスまで対応可能。
- オフライン対応
  - 一時的なネット切断中でも操作でき、復帰後に自動同期します。
- 高速なクエリ
  - インデックスが自動作成され、検索も高速です。
- セキュリティルールでアクセス管理が柔軟
  -  Firebase Authentication と連携して、ユーザーごとのアクセス制御が可能。


## よくある用途

- チャットアプリ（リアルタイム通信）
- TODO リストやメモアプリの保存
- ユーザーの操作ログや設定の保存


## 料金について

- 無料枠あり（読み書き数に制限）
- 大量のアクセスがあると課金（読み書きや保存量に応じて）


## NoSQL データベースの特徴

- データをクエリ（検索）できる
- ドキュメント単位で部分更新ができる
- 複数クライアント間でリアルタイム同期
- セキュリティルールでアクセス制御可能


## Firestore の用途

### ユーザー固有のデータの保存

Firestore には、ユーザー固有のデータを保存することができます。例えば、以下のようなデータが考えられます。

- ログインしたユーザーが保存したメモ
- 設定情報（テーマ、通知ON/OFF など）
- 投稿、コメント、ブックマーク履歴など


#### 注意点

- Firestore Security Rulesでアクセス制御すること
  - 例： `request.auth.uid == resource.data.userId` など
- 個人情報は極力避けるか、暗号化して保存すること


### 全ユーザー共通のデータの保存

Firestore は、全ユーザー共通のデータの保存にも使用できます。例えば、以下のようなデータが考えられます。

- アプリ全体で使うお知らせ
- アップデート情報
- 公開コンテンツ（記事、Q&Aなど）

ただし、アクセス頻度が高く、かつ更新頻度も高い場合は、キャッシュ ( Remote Config や CDN 、ローカル DB ) と併用する設計がベターです。


## Firestore のデータ構造

Firestore のデータ構造は、 「コレクション (サブコレクション) 」 と 「ドキュメント」 によって構成されます。

```scss
users (コレクション)
 └ userId_123 (ドキュメント)
     ├ name: "Taro"
     ├ age: 25
     └ logs (サブコレクション)
         └ log_001 (ドキュメント)
             ├ timestamp: ...
             └ event: "app_open"
```

- コレクション (サブコレクション)
  - データベースのテーブルに相当します。
  - リストのように複数の要素 (ここではドキュメント) を保持することのできるコンテナです。
  - それぞれのドキュメントは一意な ID (自動生成、または、指定) を持ちます。
  - List とは違って Firestore のコレクションは順序付きではありません。必要があれば orderBy() などでソートします。
- ドキュメント
  - データベースのレコードに相当します。
  - JSON のように 「キー & バリュー」 形式でデータを保持します。
  - ドキュメントの中に、コレクション (これをサブコレクションと呼ぶ) を持たせることが可能です。
  - サブコレクションを持てることで、階層構造を実現します。


## 引用元資料

- ChatGPT





