- [App Check](#app-check)
  - [✅ Firebase App Check の主な目的](#-firebase-app-check-の主な目的)
  - [🔒 仕組みの概要](#-仕組みの概要)
  - [🔧 Android の導入手順（概要）](#-android-の導入手順概要)
  - [💡 注意点](#-注意点)
  - [引用元資料](#引用元資料)


# App Check

Firebase App Check は、不正なアクセスや abuse（悪用）から Firebase のバックエンドサービスを保護する仕組みです。特に、認証が不要な Firebase のサービス（Realtime Database、Cloud Firestore、Cloud Storage、Functions など）を利用している場合、正規のアプリからのアクセスであることを保証したい場面で有効です。


## ✅ Firebase App Check の主な目的

- 正規のアプリからのアクセスのみを許可
  - Web、iOS、Android などで実行されている“信頼できる環境”からのアクセスのみを通す

- バックエンドサービスの abuse (不正利用) を防止
  - 不正アクセスやスクリプトからの自動攻撃（ボット）などを排除


## 🔒 仕組みの概要

- App Check プロバイダを導入
  - Android: Play Integrity API（または SafetyNet）
  - iOS: DeviceCheck または App Attest
  - Web: reCAPTCHA v3 または reCAPTCHA Enterprise
- アプリから App Check トークンを取得
  - 正規の端末・アプリであることを証明するトークンが発行される
- Firebase サーバー側でトークンを検証
  - トークンが有効な場合のみアクセスを許可する


## 🔧 Android の導入手順（概要）

- Firebase コンソールで App Check を有効化
- App Check プロバイダを選択（例: Play Integrity）
- 依存関係を追加

```kotlin
implementation 'com.google.firebase:firebase-appcheck-playintegrity'
```

- 初期化コードを追加（通常は Application クラスで）

```kotlin
FirebaseApp.initializeApp(this)
FirebaseAppCheck.getInstance().installAppCheckProviderFactory(
    PlayIntegrityAppCheckProviderFactory.getInstance()
)
```


## 💡 注意点

- App Check を有効にすると、有効なトークンを持たないアプリからのアクセスは自動的に拒否される。
- 既存アプリに追加する場合は、ユーザーへの影響が出ないように **猶予期間（デバッグモードなど）** を設けることが推奨される。
- テスト中は AppCheckDebugProvider を使うことでデバッグ環境でも開発が可能。


## 引用元資料

- ChatGPT




